!function(G,h,P){"use strict";var T="ht",U=G[T],p=U.Default,_=U.graph,x=p.getInternal(),t=x.ui(),n=t.NodeUI.prototype,s=t.ShapeUI.prototype,d=_.GraphView,R=d.prototype,H=t.EdgeUI.prototype,Y=U.Node,e=U.Shape,A=U.Edge,y=U.Group,r=p.isTouchable,S=p.preventDefault,l=G.setTimeout,z=p.grow,D=p.isDragging,I=p.getDistance,E=null,M=U.List,X="undefined"!=typeof Float32Array?Float32Array:Array,w=Math,c=w.PI,K="Crossing",V="No Crossing",f=c/2,g=2*c,i=w.atan2,B=w.sqrt,C=w.pow,k=w.sin,Z=w.cos,L=w.min,u=w.max,a=w.abs,m=w.ceil,W=w.round,J=p.unionPoint,F=p.unionRect,j=p.containsPoint,o=p.clone,b="rgb(52, 152, 219)",q="red",O={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},$={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var L=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],P=0;P<L.length;P++){var d=L[P];d=0===P%2?d/400*$.width:d/100*$.height,L[P]=d}return $.width>120&&(L[4]=$.width-26,L[6]=$.width-40,L[10]=$.width-40,L[12]=$.width-26,L[18]=33),L}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},N={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:b,rotation:.61},{type:"circle",rect:[200,120,70,70],background:b,rotation:.61},{type:"circle",rect:[200,220,70,70],background:b,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:b},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:b}]},v={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:q,rotation:.61}]},Q={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:b},{type:"circle",rect:[0,210,90,90],background:b},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:b}]},Rk={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:q},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:q}]},Wg={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:b}]},cc={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:q}]},Ad={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},vr={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},zh=function(o){var E=o.touches[0];return E?E:o.changedTouches[0]},Yi=function(I,A,V,y){return i(y-A,V-I)},Yj=function(v,y){return{x:v.x*y,y:v.y*y}},He=function(B,V){var h,f,Z,o,$=B._layers,w=B.sm().getSelection()._as,F=w.length;if($)for(h=0;h<$.length;h++){o=$[h];for(var T=0;F>T;T++)if(f=w[T],f._layer===o&&(Z=V(f),Z===!1))return}else for(h=0;F>h;h++)if(f=w[h],Z=V(f),Z===!1)return},Pr=function(F,N,U){var G,x,W,t,J,k=this,Z=N,$=k.gv;if(F instanceof e){W=F.getSegments();var R=$.getDataUI(F);J=R._55O.$15l,W||(W=gl(J)),F.isClosePath()&&W.indexOf(5)<0&&(W=new M(W._as),W.add(5)),G=Ne(F,R,Z),x=J[G]}else{var O=$.getDataUI(F);J=pd(O,F.s("edge.points")),W=F.s("edge.segments"),W||(W=gl(J)),J=J._as,G=Ne(F,O,Z),x=J[G]}if(W&&(t=W.get(Z)),2===t||1===t||5===t){var w=J[G+1];5===t&&(w=J[0]);var f=nq(x,U,w);return f}return U},Um=function(K,Y){var I,C,i,G,E=K._layers,h=K.sm().getSelection()._as,r=h.length;if(E)for(I=E.length-1;I>=0;I--){G=E[I];for(var U=r-1;U>=0;U--)if(C=h[U],C._layer===G&&(i=Y(C),i===!1))return}else for(I=r-1;I>=0;I--)if(C=h[I],i=Y(C),i===!1)return},us=function(j,i,F,N){var e=i/2,d=F/2,f=Tp(j,-e,-d,N),T=Tp(j,e,-d,N),z=Tp(j,-e,d,N),o=Tp(j,e,d,N),K=Tp(j,0,-d,N),G=Tp(j,e,0,N),U=Tp(j,0,d,N),H=Tp(j,-e,0,N);return[f,T,z,o,K,G,U,H]},nq=function(P,D,b){var w={x:D.x-P.x,y:D.y-P.y},q={x:b.x-P.x,y:b.y-P.y},R=B(C(b.x-P.x,2)+C(b.y-P.y,2)),J={x:q.x/R,y:q.y/R},s=w.x*J.x+w.y*J.y,f={x:J.x*s,y:J.y*s};return{x:P.x+f.x,y:P.y+f.y}},Tp=function(T,W,r,t){var o=Z(t)*W-k(t)*r,m=k(t)*W+Z(t)*r;return T?{x:T.x+o,y:T.y+m}:{x:o,y:m}},Nb=function(D,O){return O>2*D?D:O/2},Fh=function(T,N,z,r){var V=I(T,N);return z=r?L(z,V):Nb(z,V),V?z/=V:z=0,{x:T.x+(N.x-T.x)*z,y:T.y+(N.y-T.y)*z}},Od=function(y,V,c,S,L){return V?(c=x.getPosition(c,x.getNodeRect(y,V)),c.x+=S||0,c.y+=L||0,c):E},Km=function(D,N){var p,G,f=D.gv,n=D._data,Y=n._40I,h=n._41I,E=n.s("edge.offset"),Q=n.s("edge.source.position"),H=n.s("edge.target.position"),Z=n.s("edge.source.offset.x"),S=n.s("edge.source.offset.y"),U=n.s("edge.target.offset.x"),l=n.s("edge.target.offset.y");if(N?(p=Od(f,Y,Q,Z,S),G=Od(f,h,H,U,l)):(p=Od(f,Y,Q),G=Od(f,h,H)),"points"===n.s("edge.type")&&E&&!n.s("edge.center")&&p){var L=n.s("edge.points")||new M,k=L.size(),R=Fh(p,k?L.get(0):G,E,k),i=Fh(G,k?L.get(k-1):p,E,k);p=R,G=i}return[p,G]},pd=function(P,b,J){var Y=P._78o,g=P._data,B=g.s("edge.type"),y=[Y._69o,Y._70o];return"points"===B?J&&(y=Km(P)):y=Y.center?B?J?Km(P):Km(P,!0):J?Km(P):[Y.c1,Y.c2]:J?Km(P):Km(P,!0),b=new M(b?b._as:E),b.add(y[0],0),b.add(y[1]),b},Qf=function(k){return k=new M(k._as),k.removeAt(0),k.removeAt(k.size()-1),k},gl=function(c){c._as||(c=new M(c));var v=new M;v.add(1);for(var t=1;t<c.size();t++)v.add(2);return v},gs=function(Z,d){return{x:(Z.x+d.x)/2,y:(Z.y+d.y)/2}},Wk=function(l,P){return{x:l.x+1*(P.x-l.x)/4,y:l.y+1*(P.y-l.y)/4}},Tf=function(p,R){return{x:p.x+3*(R.x-p.x)/4,y:p.y+3*(R.y-p.y)/4}},fh=function(s,t,y,K){var $=t.x+t.width/2,R=t.y+t.height/2,p=B($*$+R*R),Y=i(R,$)+y;return{x:K.x+p*Z(Y),y:K.y+p*k(Y)}},hg=R.validateImpl,Hm=R.isRectEditable,dg=R.isPointEditable,$r=R._42,qc=s._79o,Qk=H._79o,pl=s._48O,oe=s._47O,jo=n._48O,Oq=n._80o,ee=s._80o,mr=n._2o,Rc=n._47O,ao=H._47O,up=R.isEditable,he=["northwest","north","northeast","east","southeast","south","southwest","west"],xp=function(b,V,$,v,g,h,I,r,M,x){var i=b.x,K=b.y,N=b.width,y=b.height,B={x:i+N/2,y:K+y/2};v=v||0,V=Tp(B,V.x-B.x,V.y-B.y,-v),I&&!r&&(V.x+=M,V.y+=x);var o=.01;if("northwest"===$?(V.x+g>i+N-o&&(V.x=i+N-g-o),V.y+g>K+y-o&&(V.y=K+y-g-o),b=J(V,{x:i+N,y:K+y})):"north"===$?(V.y+g>K+y-o&&(V.y=K+y-g-o),b=J({x:i,y:V.y},{x:i+N,y:K+y})):"northeast"===$?(V.x<i+g+o&&(V.x=i+g+o),V.y+g>K+y-o&&(V.y=K+y-g-o),b=J({x:i,y:V.y},{x:V.x,y:K+y})):"west"===$?(V.x+g>i+N-o&&(V.x=i+N-g-o),b=J({x:V.x,y:K},{x:i+N,y:K+y})):"east"===$?(V.x<i+g+o&&(V.x=i+g+o),b=J({x:i,y:K},{x:V.x,y:K+y})):"southwest"===$?(V.x+g>i+N-o&&(V.x=i+N-g-o),V.y<K+g+o&&(V.y=K+g+o),b=J({x:V.x,y:K},{x:i+N,y:V.y})):"south"===$?(V.y<K+g+o&&(V.y=K+g+o),b=J({x:i,y:K},{x:i+N,y:V.y})):"southeast"===$&&(V.x<i+g+o&&(V.x=i+g+o),V.y<K+g+o&&(V.y=K+g+o),b=J({x:i,y:K},V)),"keepRatio"===h&&(!I&&r||I&&!r)&&("northeast"===$||"southeast"===$||"northwest"===$||"southwest"===$)){var t=b.width,R=b.height,j=t/N,q=R/y,H=L(j,q);b.width=N*H,b.height=y*H,"northeast"===$?b.y=K+(y-b.height):"northwest"===$?(b.y=K+(y-b.height),b.x=i+(N-b.width)):"southwest"===$&&(b.x=i+(N-b.width))}b.x-=B.x,b.y-=B.y;var Y=fh(E,b,v,B);return b.x=Y.x-b.width/2,b.y=Y.y-b.height/2,b},Ak=function(i,W,_,r){var O=i.getRotation(),c=W,F=c.x,v=c.y,k=c.width,m=c.height,l={x:F+c.width/2,y:v+c.height/2};r=Tp(l,r.x-l.x,r.y-l.y,-O),"northwest"===_?c=J(r,{x:F+k,y:v+m}):"north"===_?c=J({x:F,y:r.y},{x:F+k,y:v+m}):"northeast"===_?c=J({x:F,y:r.y},{x:r.x,y:v+m}):"west"===_?c=J({x:r.x,y:v},{x:F+k,y:v+m}):"east"===_?c=J({x:F,y:v},{x:r.x,y:v+m}):"southwest"===_?c=J({x:r.x,y:v},{x:F+k,y:r.y}):"south"===_?c=J({x:F,y:v},{x:F+k,y:r.y}):"southeast"===_&&(c=J({x:F,y:v},r)),i.setRect(c),c.x-=l.x,c.y-=l.y;var f=fh(i,c,O,l);i.p(f.x,f.y)},zb=function(Z,p,c,A,B,O,r,w){var T=E;O?(T=Tp(E,B.x-p.x,B.y-p.y,-c),T.x-=r.x,T.y-=r.y):T=Tp(E,B.x-p.x,B.y-p.y,0);var y={x:p.x+T.x,y:p.y+T.y};w&&(y=w(y.x,y.y)),y.e=Z.getPoints().get(A).e,Z.setPoint(A,y);var e=Z.getWidth(),P=Z.getHeight(),K=Z.p().x-e/2,a=Z.p().y-P/2;K-=p.x,a-=p.y;var N=fh(Z,{x:K,y:a,width:e,height:P},c,p);Z.p(N.x,N.y)},Ne=function(i,r,F){var n,j;if(i instanceof e?(n=i.getPoints(),j=i.getSegments()):i instanceof A&&"points"===i.s("edge.type")&&(n=i.s("edge.points"),j=i.s("edge.segments"),n=pd(r,n)),j||(j=gl(n)),i instanceof e&&i.isClosePath()&&j.indexOf(5)<0&&(j=new M(j._as),j.add(5)),j)for(var R=-1,D=0;D<j.size();D++){if(D===F)return R;var c=j.get(D);1===c?R+=1:2===c?R+=1:3===c?R+=2:4===c&&(R+=3)}},Fe=function(H,t,k){var I,B;if(H instanceof e?(I=H.getPoints(),B=H.getSegments()):H instanceof A&&"points"===H.s("edge.type")&&(I=H.s("edge.points"),B=H.s("edge.segments"),I=pd(t,I)),B||(B=gl(I)),B)for(var d=-1,j=0;j<B.size();j++){var W=B.get(j);if(1===W?d+=1:2===W?d+=1:3===W?d+=2:4===W&&(d+=3),d===k)return j}},qi=function(Y,O){var F=[Y[0]-O[0],Y[1]-O[1],Y[2]-O[2]];return F},jr=function(){var r=new X(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ln=function(b,d){var q=b[0],I=b[1],m=b[2];return b[0]=d[0]*q+d[4]*I+d[8]*m+d[12],b[1]=d[1]*q+d[5]*I+d[9]*m+d[13],b[2]=d[2]*q+d[6]*I+d[10]*m+d[14],b},hh=function(U,s){if(s){var l=k(s),z=Z(s),H=U[0],e=U[1],i=U[2],S=U[3],I=U[8],u=U[9],X=U[10],r=U[11];U[0]=H*z-I*l,U[1]=e*z-u*l,U[2]=i*z-X*l,U[3]=S*z-r*l,U[8]=H*l+I*z,U[9]=e*l+u*z,U[10]=i*l+X*z,U[11]=S*l+r*z}},Ub=function(A,H){for(var w=A.s("grid.row.count"),Q=A.s("grid.column.count"),m=0;w>m;m++)for(var _=0;Q>_;_++){var I=A.getCellRect(m,_);if(j(I,H))return{rowIndex:m,columnIndex:_,rect:I,grid:A}}return null},$k=function($,r,P,z,I,A){var t={},a=P-$,u=z-r,K=w.sqrt(a*a+u*u),f=a/K,v=u/K,X=(-$+I)*f+(-r+A)*v;return 0>=X?(t.x=$,t.y=r):X>=K?(t.x=P,t.y=z):(t.x=$+X*f,t.y=r+X*v),a=I-t.x,u=A-t.y,t.z=w.sqrt(a*a+u*u),t},og=function(n,R){var W,S,Z,e,J,D,X,q,k=n.getPoints(),P=n.getSegments(),O=n.p(),o=n.getRotation();if(!P||!(P.indexOf(3)>0||P.indexOf(4)>0)){for(q=0;q<=k.size()-1;q++)if(q===k.size()-1?(J=k.get(0),e=k.get(q)):(e=k.get(q),J=k.get(q+1)),e=Tp(O,e.x-O.x,e.y-O.y,o),J=Tp(O,J.x-O.x,J.y-O.y,o),D=$k(e.x,e.y,J.x,J.y,R.x,R.y),X=D.z,X<(n.s("shape.border.width")||10)){S=e,Z=J,W=q;break}if(W!=E){var Q=$k(S.x,S.y,Z.x,Z.y,R.x,R.y),i=I(S,Q);return{attachIndex:W,attachOffset:i}}}},sr=function(l){for(var P=l._data,z=P.p(),q=P.getRotation(),W=P.getPoints(),m=E,y=[],Z=0;Z<W.size();Z++)m=W.get(Z),y.push(Tp(z,m.x-z.x,m.y-z.y,q));l._55O.$15l=y};R._editPointSize=r?24:9,R._edgeHelpers=["parent","remove","source","target"],R._leftTopHelpers=["parent"],R._rightTopHelpers=["host"],R._leftBottomHelpers=["edge"],R._rightBottomHelpers=["remove"],he=he.concat(he).concat(he),H._79o=function(){var x=this,X=x.gv,Y=X.getZoom(),l=X._editInteractor,y=Qk.call(x),O=Km(x,!0),v=O[0],a=O[1],U={x:y.x,y:y.y,width:y.width,height:y.height},m=J(v,a);if(l instanceof _.XEditInteractor){U=F(U,m);var t=x._55O,A=X.getEditPointSize()/Y+2,j=0;t&&t._43O&&(j+=A/2,z(U,j))}return U},H._47O=function(f){var Y=this,d=Y.gv,D=d._editInteractor;D instanceof _.XEditInteractor||ao.call(Y,f)},H.rectIntersects=function(J){var d=this,i=d._data,b=d.gv,T=b.getZoom(),Y=d._55O,e=b._editInteractor;if(e instanceof _.XEditInteractor&&b.isEditable(i)&&Y&&Y._43O&&"points"===i.s("edge.type")){var a=i.s("edge.points"),m=i.s("edge.segments");a=pd(d,a),m||(m=gl(a)),a=a._as;var I=!1,v=r?5:1,x=J.x+v,n=J.y+v,p={x:x,y:n};if(e._edge===i&&e._hoverSegmentIndex>=0){var y=b._editInteractor._hoverSegmentIndex,P=m.get(y),U=Ne(i,d,y),j=E;if(U!=E&&U>=0){var D=a[U],u=b.getSegmentHoverWidth()/T;if(2===P||1===P){var C=a[U+1];j=cn(new Wq(D.x,D.y),new Wq(C.x,C.y),new Wq(p.x-u,p.y-u),new Wq(p.x+2*u,p.y+2*u)),j.$62l===K&&(I=!0)}else if(3===P){var B=a[U+1],C=a[U+2];j=fk(new Wq(D.x,D.y),new Wq(B.x,B.y),new Wq(C.x,C.y),new Wq(p.x-u,p.y-u),new Wq(p.x+2*u,p.y+2*u)),j.$62l===K&&(I=!0)}else if(4===P){var N=a[U+1],f=a[U+2];C=a[U+3],j=mq(new Wq(D.x,D.y),new Wq(N.x,N.y),new Wq(f.x,f.y),new Wq(C.x,C.y),new Wq(p.x-u,p.y-u),new Wq(p.x+2*u,p.y+2*u)),j.$62l===K&&(I=!0)}}}if(I)return!0}return E},s._47O=function(Z){var z=this,s=z.gv,v=s._editInteractor;v instanceof _.XEditInteractor||oe.call(z,Z)},s.rectIntersects=function(Q){var e=this,U=e._data,B=e.gv,u=B.getZoom(),w=e._55O,I=B._editInteractor;if(I instanceof _.XEditInteractor&&B.isEditable(U)&&w&&w._43O){var c=w.$15l,R=!1,G=r?5:1,k=Q.x+G,C=Q.y+G,N={x:k,y:C};if(c&&c.length===U.getPoints().size()||(sr(e),c=w.$15l),I._shape===U&&I._hoverSegmentIndex>=0){var V=U.getSegments();V||(V=gl(c));var H=B._editInteractor._hoverSegmentIndex,n=V.get(H),v=Ne(U,e,H),Z=E;if(v!=E&&v>=0){var b=c[v],h=B.getSegmentHoverWidth()/u;if(2===n||1===n){var A=c[v+1];Z=cn(new Wq(b.x,b.y),new Wq(A.x,A.y),new Wq(N.x-h,N.y-h),new Wq(N.x+2*h,N.y+2*h)),Z.$62l===K&&(R=!0)}else if(3===n){var Y=c[v+1],A=c[v+2];Z=fk(new Wq(b.x,b.y),new Wq(Y.x,Y.y),new Wq(A.x,A.y),new Wq(N.x-h,N.y-h),new Wq(N.x+2*h,N.y+2*h)),Z.$62l===K&&(R=!0)}else if(4===n){var p=c[v+1],X=c[v+2];A=c[v+3],Z=mq(new Wq(b.x,b.y),new Wq(p.x,p.y),new Wq(X.x,X.y),new Wq(A.x,A.y),new Wq(N.x-h,N.y-h),new Wq(N.x+2*h,N.y+2*h)),Z.$62l===K&&(R=!0)}}}if(R)return!0}return E},s._48O=function(){var Q=this,r=Q.gv,y=r._editInteractor;y instanceof _.XEditInteractor?(n._48O.call(Q),Q._55O._43O&&sr(Q)):pl.call(Q)},s._79o=function(){var u=this,g=u.gv,n=g.getZoom(),U=g._editInteractor,Y=qc.call(u);if(Y){var r={x:Y.x,y:Y.y,width:Y.width,height:Y.height};if(U instanceof _.XEditInteractor){var B=u._55O,k=g.getEditPointSize()/n+2,D=0;B&&B._43O&&(D+=k/2,z(r,D))}return r}},n._47O=function(X){var w=this,y=w.gv,r=y._editInteractor;if(r instanceof _.XEditInteractor);else{var F=w._55O;F&&F._98o&&Rc.call(w,X)}},n._2o=function(){var D=this,n=D.gv,J=n._editInteractor,c=D._data;return n.isEditable(c)&&J instanceof _.XEditInteractor?0:mr.call(D)},n._80o=function(j){var g=this,v=g.gv._editInteractor;if(Oq.call(g,j),v&&v._debug){j.save(),j.beginPath(),j.lineWidth=1,j.strokeStyle="green";var G=g._79o();G&&(j.rect(G.x,G.y,G.width,G.height),j.stroke()),j.restore()}},s._80o=function(U){var Y=this,O=Y.gv._editInteractor;if(ee.call(Y,U),O&&O._debug){U.save(),U.beginPath(),U.lineWidth=1,U.strokeStyle="green";var t=Y._79o();U.rect(t.x,t.y,t.width,t.height),U.stroke(),U.restore()}},n._48O=function(){var W=this,b=W.gv,I=W._data,J=b._editInteractor,K=W._55O,F=I.p(),E=I.getRotation();if(J instanceof _.XEditInteractor){if(K._42O){var m=us(F,I.getWidth(),I.getHeight(),E),h=m[0],d=m[1],o=m[2],M=m[3],B=m[4],g=m[5],C=m[6],s=m[7];K.$45l=[h,B,d,g,M,C,o,s]}}else jo.call(W)},R.getResizeMode=function(){return this.$25l||"normal"},R.setResizeMode=function(r){var U=this.$25l;this.$25l=r,this.fp("resizeMode",U,r)},R.getSnapAngle=function(){return this.$26l||Math.PI/36},R.setSnapAngle=function(s){var E=this.$26l;this.$26l=s,this.fp("snapAngle",E,s)},R.getSnapSpacing=function(){return this.$27l},R.setSnapSpacing=function(w){var y=this.$27l;this.$27l=w,this.fp("snapSpacing",y,w)},R.getPointSnapSpacing=function(){return this._pointSnapSpacing},R.setPointSnapSpacing=function(f){var C=this._pointSnapSpacing;this._pointSnapSpacing=f,this.fp("pointSnapSpacing",C,f)},R.setHelperEditableFunc=function(c){var v=this._helperEditableFunc;this._helperEditableFunc=c,this.fp("helperEditableFunc",v,c)},R.getHelperEditableFunc=function(){return this._helperEditableFunc},R.setLeftTopHelpers=function(A){var n=this._leftTopHelpers;this._leftTopHelpers=A,this.fp("leftTopHelpers",n,A)},R.getLeftTopHelpers=function(){return this._leftTopHelpers},R.setLeftTopHelpersAlign=function(f){var m=this._leftTopHelpersAlign;this._leftTopHelpersAlign=f,this.fp("leftTopHelpersAlign",m,f)},R.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},R.setRightTopHelpers=function(B){var Z=this._rightTopHelpers;this._rightTopHelpers=B,this.fp("rightTopHelpers",Z,B)},R.getRightTopHelpers=function(){return this._rightTopHelpers},R.setRightTopHelpersAlign=function(H){var p=this._rightTopHelpersAlign;this._rightTopHelpersAlign=H,this.fp("rightTopHelpersAlign",p,H)},R.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},R.setLeftBottomHelpers=function(U){var W=this._leftBottomHelpers;this._leftBottomHelpers=U,this.fp("leftBottomHelpers",W,U)},R.getLeftBottomHelpers=function(){return this._leftBottomHelpers},R.setLeftBottomHelpersAlign=function(n){var U=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=n,this.fp("leftBottomHelpersAlign",U,n)},R.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},R.setRightBottomHelpers=function(w){var i=this._rightBottomHelpers;this._rightBottomHelpers=w,this.fp("rightBottomHelpers",i,w)},R.getRightBottomHelpers=function(){return this._rightBottomHelpers},R.setRightBottomHelpersAlign=function(B){var A=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=B,this.fp("rightBottomHelpersAlign",A,B)},R.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},R.setEdgeHelpers=function(I){var H=this._edgeHelpers;this._edgeHelpers=I,this.fp("edgeHelpers",H,I)},R.getEdgeHelpers=function(){return this._edgeHelpers},R.isHelperEditable=function(s,I){return s instanceof A&&("host"===I||"edge"===I||"elevation"===I||"tall"===I)?!1:s instanceof Y&&("source"===I||"target"===I)?!1:"pointElevation"===I?this._helperEditableFunc?this._helperEditableFunc(s,I):!1:this._helperEditableFunc?this._helperEditableFunc(s,I):!0},R.getEditHelperSize=function(){return this._editHelperSize||(r?28:16)},R.setEditHelperSize=function(B){var s=this._editHelperSize;this._editHelperSize=B,this.fp("editHelperSize",s,B)},R.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},R.setEditRectBorderColor=function(b){var l=this.$28l;this.$28l=b,this.fp("editRectBorderColor",l,b)},R.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},R.setNodeBorderColor=function(f){var i=this.$29l;this.$29l=f,this.fp("nodeBorderColor",i,f)},R.getEditRectBorderStyle=function(){return this.$30l||"dashed"},R.setEditRectBorderStyle=function(b){var v=this.$30l;this.$30l=b,this.fp("editRectBorderStyle",v,b)},R.getControlPointBackground=function(){return this.$31l||"#ff0"},R.setControlPointBackground=function(y){var i=this.$31l;this.$31l=y,this.fp("controlPointBackground",i,y)},R.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},R.setControlPointBorderColor=function(n){var J=this.$32l;this.$32l=n,this.fp("controlPointBorderColor",J,n)},R.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},R.setJoinPointBackground=function(R){var Z=this.$33l;this.$33l=R,this.fp("joinPointBackground",Z,R)},R.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},R.setJoinPointBorderColor=function(k){var $=this.$34l;this.$34l=k,this.fp("joinPointBorderColor",$,k)},R.getDirectionLineColor=function(){return this.$35l||"#888"},R.setDirectionLineColor=function(W){var z=this.$35l;this.$35l=W,this.fp("directionLineColor",z,W)},R.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},R.setSegmentHoverColor=function(q){var P=this.$36l;this.$36l=q,this.fp("segmentHoverColor",P,q)},R.getSegmentHoverWidth=function(){return this.$22l||(r?16:8)},R.setSegmentHoverWidth=function(f){var X=this.$22l;this.$22l=f,this.fp("segmentHoverWidth",X,f)},R.getSnapPointBorderColor=function(){return this.$38l||"#f00"},R.setSnapPointBorderColor=function(u){var K=this.$38l;this.$38l=u,this.fp("snapPointBorderColor",K,u)},R.getEditRectPadding=function(){return this.$39l!=E?this.$39l:6},R.setEditRectPadding=function(G){var m=this.$39l;this.$39l=G,this.fp("editRectPading",m,G)},R.isRectEditable=function(x){var o=this,E=o._editInteractor;return E instanceof _.XEditInteractor?o._rectEditableFunc?o._rectEditableFunc(x):!0:Hm.call(o,x)},R.isPointEditable=function(w){var A=this,S=A._editInteractor;return S instanceof _.XEditInteractor?A._pointEditableFunc?A._pointEditableFunc(w):!0:dg.call(A,w)},R.validateImpl=function(){var R=this,N=R.$14l,J=R._editInteractor;if(N){var $=R.getWidth(),V=R.getHeight();($!==N.clientWidth||V!==N.clientHeight)&&(J&&(J._68I=1),x.setCanvas(N,$,V),R._32I=1)}hg.call(this)},R.isEditable=function(P){var a=up.call(this,P),O=this._editInteractor;if(O instanceof _.XEditInteractor&&P instanceof A){P.getSource()==P.getTarget()&&(a=!1);var w=this.getEditableFunc();a=w?w(P):!0}return a},R._42=function(Q,o){var z=this,U=z._editInteractor;$r.call(z,Q,o),U instanceof _.XEditInteractor&&U._68I&&U._42()},R.isSnapPoint=function(){return!0};var Ii=function(U){arguments.length>0&&this.$58l(U)},ar=Ii.prototype;ar.$58l=function(I){this.$62l=I,this.points=new Array},ar.$56l=function(T){this.points.push(T)},ar.$57l=function(O){this.points=this.points.concat(O)};var Wq=function(l,P){arguments.length>0&&this.$58l(l,P)},nd=Wq.prototype;nd.$58l=function(w,C){this.x=w,this.y=C},nd.add=function(M){return new Wq(this.x+M.x,this.y+M.y)},nd.addEquals=function(s){return this.x+=s.x,this.y+=s.y,this},nd.$55l=function(A){return new Wq(this.x*A,this.y*A)},nd.eq=function(t){return this.x==t.x&&this.y==t.y},nd.lt=function(t){return this.x<t.x&&this.y<t.y},nd.lte=function(N){return this.x<=N.x&&this.y<=N.y},nd.gt=function(G){return this.x>G.x&&this.y>G.y},nd.gte=function(y){return this.x>=y.x&&this.y>=y.y},nd.lerp=function(w,D){return new Wq(this.x+(w.x-this.x)*D,this.y+(w.y-this.y)*D)},nd.distanceFrom=function(z){var f=this.x-z.x,q=this.y-z.y;return B(f*f+q*q)},nd.min=function(D){return new Wq(L(this.x,D.x),L(this.y,D.y))},nd.max=function(D){return new Wq(u(this.x,D.x),u(this.y,D.y))},nd.toString=function(){return this.x+","+this.y};var Re=function(){this.$58l(arguments)},kd=Re.prototype;Re.TO=1e-6,Re.AC=6,kd.$58l=function(T){this.co=new Array;for(var f=T.length-1;f>=0;f--)this.co.push(T[f])},kd.$55l=function(N){for(var D=new Re,X=0;X<=this.$50l()+N.$50l();X++)D.co.push(0);for(var X=0;X<=this.$50l();X++)for(var I=0;I<=N.$50l();I++)D.co[X+I]+=this.co[X]*N.co[I];return D},kd.$59l=function(){for(var Z=this.$50l();Z>=0&&a(this.co[Z])<=Re.TO;Z--)this.co.pop()},kd.$50l=function(){return this.co.length-1},kd.$51l=function(){var l;switch(this.$59l(),this.$50l()){case 0:l=new Array;break;case 1:l=this.$52l();break;case 2:l=this.$53l();break;case 3:l=this.$54l();break;case 4:l=this.$63l();break;default:l=new Array}return l},kd.$52l=function(){var w=new Array,S=this.co[1];return 0!=S&&w.push(-this.co[0]/S),w},kd.$53l=function(){var l=new Array;if(2==this.$50l()){var O=this.co[2],H=this.co[1]/O,o=this.co[0]/O,g=H*H-4*o;if(g>0){var M=B(g);l.push(.5*(-H+M)),l.push(.5*(-H-M))}else 0==g&&l.push(.5*-H)}return l},kd.$63l=function(){var R=new Array;if(4==this.$50l()){var g=this.co[4],q=this.co[3]/g,n=this.co[2]/g,$=this.co[1]/g,T=this.co[0]/g,D=new Re(1,-n,q*$-4*T,-q*q*T+4*n*T-$*$).$54l(),e=D[0],N=q*q/4-n+e;if(a(N)<=Re.TO&&(N=0),N>0){var H=B(N),y=3*q*q/4-H*H-2*n,X=(4*q*n-8*$-q*q*q)/(4*H),A=y+X,w=y-X;if(a(A)<=Re.TO&&(A=0),a(w)<=Re.TO&&(w=0),A>=0){var t=B(A);R.push(-q/4+(H+t)/2),R.push(-q/4+(H-t)/2)}if(w>=0){var t=B(w);R.push(-q/4+(t-H)/2),R.push(-q/4-(t+H)/2)}}else if(0>N);else{var X=e*e-4*T;if(X>=-Re.TO){if(0>X&&(X=0),X=2*B(X),y=3*q*q/4-2*n,y+X>=Re.TO){var F=B(y+X);R.push(-q/4+F/2),R.push(-q/4-F/2)}if(y-X>=Re.TO){var F=B(y-X);R.push(-q/4+F/2),R.push(-q/4-F/2)}}}}return R},kd.$54l=function(){var h=new Array;if(3==this.$50l()){var o=this.co[3],r=this.co[2]/o,O=this.co[1]/o,p=this.co[0]/o,l=(3*O-r*r)/3,u=(2*r*r*r-9*O*r+27*p)/27,X=r/3,t=u*u/4+l*l*l/27,x=u/2;if(a(t)<=Re.TO&&(t=0),t>0){var D,V,Y=B(t);D=-x+Y,V=D>=0?C(D,1/3):-C(-D,1/3),D=-x-Y,D>=0?V+=C(D,1/3):V-=C(-D,1/3),h.push(V-X)}else if(0>t){var R=B(-l/3),E=i(B(-t),-x)/3,q=Z(E),d=k(E),g=B(3);h.push(2*R*q-X),h.push(-R*(q+g*d)-X),h.push(-R*(q-g*d)-X)}else{var D;D=x>=0?-C(x,1/3):C(-x,1/3),h.push(2*D-X),h.push(-D-X)}}return h};var qf=function(K,C){arguments.length>0&&this.$58l(K,C)},Vl=qf.prototype;Vl.$58l=function(R,W){this.x=R,this.y=W},Vl.length=function(){return B(this.x*this.x+this.y*this.y)},Vl.$60l=function(K){return this.x*K.x+this.y*K.y};var kj=function(R,s,Y,z){var w,j=(z.x-Y.x)*(R.y-Y.y)-(z.y-Y.y)*(R.x-Y.x),E=(s.x-R.x)*(R.y-Y.y)-(s.y-R.y)*(R.x-Y.x),W=(z.y-Y.y)*(s.x-R.x)-(z.x-Y.x)*(s.y-R.y);if(0!=W){var U=j/W,m=E/W;U>=0&&1>=U&&m>=0&&1>=m?(w=new Ii(K),w.points.push(new Wq(R.x+U*(s.x-R.x),R.y+U*(s.y-R.y)))):w=new Ii(V)}else w=0==j||0==E?new Ii("C"):new Ii("P");return w},nc=function(B,O,L,H,Z){var Q,U,X,u,c,W,m,w=H.min(Z),n=H.max(Z),o=new Ii(V);Q=O.$55l(-2),X=B.add(Q.add(L)),Q=B.$55l(-2),U=O.$55l(2),u=Q.add(U),c=new Wq(B.x,B.y),m=new qf(H.y-Z.y,Z.x-H.x),W=H.x*Z.y-Z.x*H.y;for(var R=new Re(m.$60l(X),m.$60l(u),m.$60l(c)+W).$51l(),D=0;D<R.length;D++){var b=R[D];if(b>=0&&1>=b){var f=B.lerp(O,b),s=O.lerp(L,b),t=f.lerp(s,b);H.x==Z.x?w.y<=t.y&&t.y<=n.y&&(o.$62l=K,o.$56l(t)):H.y==Z.y?w.x<=t.x&&t.x<=n.x&&(o.$62l=K,o.$56l(t)):t.gte(w)&&t.lte(n)&&(o.$62l=K,o.$56l(t))}}return o},fk=function(X,R,q,J,b){var O=J.min(b),x=J.max(b),C=new Wq(x.x,O.y),M=new Wq(O.x,x.y),u=nc(X,R,q,O,C),Y=nc(X,R,q,C,x),k=nc(X,R,q,x,M),v=nc(X,R,q,M,O),F=new Ii(V);return F.$57l(u.points),F.$57l(Y.points),F.$57l(k.points),F.$57l(v.points),F.points.length>0&&(F.$62l=K),F},yp=function(B,G,L,D,S,v){var j,Z,k,C,b,A,$,H,U,x,d=S.min(v),m=S.max(v),u=new Ii(V);j=B.$55l(-1),Z=G.$55l(3),k=L.$55l(-3),C=j.add(Z.add(k.add(D))),b=new qf(C.x,C.y),j=B.$55l(3),Z=G.$55l(-6),k=L.$55l(3),C=j.add(Z.add(k)),A=new qf(C.x,C.y),j=B.$55l(-3),Z=G.$55l(3),k=j.add(Z),$=new qf(k.x,k.y),H=new qf(B.x,B.y),x=new qf(S.y-v.y,v.x-S.x),U=S.x*v.y-v.x*S.y;for(var T=new Re(x.$60l(b),x.$60l(A),x.$60l($),x.$60l(H)+U).$51l(),l=0;l<T.length;l++){var o=T[l];if(o>=0&&1>=o){var w=B.lerp(G,o),z=G.lerp(L,o),W=L.lerp(D,o),Y=w.lerp(z,o),g=z.lerp(W,o),h=Y.lerp(g,o);S.x==v.x?d.y<=h.y&&h.y<=m.y&&(u.$62l=K,u.$56l(h)):S.y==v.y?d.x<=h.x&&h.x<=m.x&&(u.$62l=K,u.$56l(h)):h.gte(d)&&h.lte(m)&&(u.$62l=K,u.$56l(h))}}return u},mq=function($,S,x,q,h,o){var l=h.min(o),e=h.max(o),Z=new Wq(e.x,l.y),T=new Wq(l.x,e.y),L=yp($,S,x,q,l,Z),m=yp($,S,x,q,Z,e),p=yp($,S,x,q,e,T),G=yp($,S,x,q,T,l),J=new Ii(V);return J.$57l(L.points),J.$57l(m.points),J.$57l(p.points),J.$57l(G.points),J.points.length>0&&(J.$62l=K),J},cn=function(Y,m,l,t){var _=l.min(t),N=l.max(t),c=new Wq(N.x,_.y),w=new Wq(_.x,N.y),U=kj(_,c,Y,m),k=kj(c,N,Y,m),Z=kj(N,w,Y,m),y=kj(w,_,Y,m),i=new Ii(V);return i.$57l(U.points),i.$57l(k.points),i.$57l(Z.points),i.$57l(y.points),i.points.length>0&&(i.$62l=K),i},cm=_.XEditInteractor=function(T){var Z=this,y=Z._view=document.createElement("canvas");y.className="editCanvas",y.style.position="absolute",cm.superClass.constructor.call(Z,T)};p.def(cm,_.Interactor,{ms_edit:1,setUp:function(){var T=this,X=T.gv,u=X.getView(),x=T._view;cm.superClass.setUp.call(T),X.setEditInteractor(T),X.$14l=x,X._79O?u.insertBefore(x,X._79O):u.appendChild(x);var D=T.$49l=T.$11l.bind(T);X.dm().md(D),X.sm().ms(D),X.mp(D)},tearDown:function(){var S=this,q=S.gv,Z=q.getView(),J=S.$49l;cm.superClass.tearDown.call(S),q.setEditInteractor(E),q.$14l=E,Z.removeChild(S._view),q.dm().umd(J),q.sm().ums(J),q.ump(J)},clear:function(){var R=this,y=R.gv;delete R._hoverSegmentIndex,delete R._edge,delete R._shape,delete y._editing,delete R.$10l,delete R.$13l,delete R.$9l,delete R._removePointIndex,delete R._lp,R.$12l="",delete R.$40l,delete R.$67l,delete R.$72l,delete R.$73l,delete R.$75l,delete R.$1l,delete R.$3l,delete R.$2l,delete R.$92l,delete R.$93l,delete R.$94l,R.clearDragging()},handle_keydown:function(M){this.$48l!==M.shiftKey&&(this.$48l=M.shiftKey,this.handle_mousemove(M,P,!0))},handle_keyup:function(e){this.$48l!==e.shiftKey&&(this.$48l=e.shiftKey,this.handle_mousemove(e,P,!0))},handle_touchstart:function(H){this.handle_mousemove(H),this.handle_mousedown(H)},handle_mousedown:function(E){S(E);var y=this,R=y.$13l,Z=y.gv,f=Z.dm(),K=f.getHistoryManager(),s=Z.sm(),D=Z.getZoom(),T=Z.lp(E),t=p.isDoubleClick(E),b=p.isLeftButton(E),V=y.$7l,a=y._shape,i=y._hoverSegmentIndex,h=y._edge,U=y.$87l,C=y.$88l,F=function(){y._68I||U===y.$87l&&C===y.$88l||y.$43l()};if(7!==y.$67l&&(delete y.$87l,delete y.$88l),b&&(a||h)&&i>=0&&t&&(a&&s.contains(a)||h&&s.contains(h))){var v=Pr.call(y,a||h,i,T);return y.addShapePoint(a||h,i,v),l(function(){y.handle_mousemove(E)},40),void 0}if(b&&(a||h)&&y._removePointIndex>=0&&t)return y.removeShapePoint(),y.$5l=1,l(function(){y.handle_mousemove(E)},40),void 0;if(!b||!Z._editing)return F(),void 0;if(a&&R>=0){var N=a.getPoints().get(R),m=a.p(),q=Tp(m,N.x-m.x,N.y-m.y,-V+a.getRotation());Q=Tp(m,T.x-m.x,T.y-m.y,-V),y.$24l={x:Q.x-q.x,y:Q.y-q.y},y.startDragging(E),K&&K.beginInteraction(),y.fi({kind:"beginEditPoint",event:E,data:a,index:R}),y.$88l=R,y.$87l=a}else if(y.$10l){var z=Z.sm().getSelection(),_=y.$6l,j=y.$1l={},J=y.$3l={},g=y.$16l[O[y.$10l]],X={x:_.x,y:_.y},G={x:_.x+_.width/2,y:_.y+_.height/2};y.$24l={x:T.x-g.x/D,y:T.y-g.y/D},y.$2l=o(y.$8l),y.$4l=o(_),z.each(function(u){if(u instanceof Y){var B=u.p(),x=u.getWidth(),l=u.getHeight(),R=Tp(G,B.x-G.x,B.y-G.y,-V);j[u.getId()]={x:B.x-x/2,y:B.y-l/2,width:x,height:l},J[u.getId()]={x:(R.x-X.x)/_.width,y:(R.y-X.y)/_.height}}}),y.startDragging(E),K&&K.beginInteraction(),y.fi({kind:"beginEditRect",event:E,direction:y.$10l})}else if(h&&R>=0){var I=pd(Z.getDataUI(h),h.s("edge.points")),N=I.get(R);y.$24l={x:T.x-N.x,y:T.y-N.y},y.startDragging(E),K&&K.beginInteraction(),y.fi({kind:"beginEditPoint",event:E,data:h,index:R}),y.$88l=R,y.$87l=h}else if(y.$40l){var _=y.$6l,G={x:_.x+_.width/2,y:_.y+_.height/2},u=o(y.$23l);u.x/=D,u.y/=D;var P=Tp(G,u.x-G.x,u.y-G.y,-V),Q=Tp(G,T.x-G.x,T.y-G.y,-V);y.$24l={x:Q.x-P.x,y:Q.y-P.y},y.startDragging(E),K&&K.beginInteraction(),y.fi({kind:"beginEditRotation",event:E,data:y._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(y.$67l)>=0)y.startDragging(E);else if(y.$71l&&t&&y.$79l(y.$71l,T)){var x=s.toSelection();K&&K.beginInteraction(),x.each(function(Z){f.remove(Z)}),K&&K.endInteraction()}F()},$11l:function(){var t=this,G=t.gv;G._editing&&(t.$13l==E||t._shape==E&&t._edge==E)&&(t.$73l==E||1!==t.$67l&&5!==t.$67l&&6!==t.$67l)||(t.$5l=1),t._68I=1},$46l:function(d){var p=this,J=p.gv,t=J.lp(d),s=[];return Um(J,function(b){var e=J.getDataUI(b);if(e){var P=e._79o();j(P,t)&&s.push(b)}}),s},$47l:function(t){var x=this,R=x.$13l,c=x.gv.dm(),S=c.getHistoryManager();x.$10l?(x.fi({kind:"endEditRect",event:t,direction:x.$10l}),S&&S.endInteraction()):x._shape&&R>=0?(x.fi({kind:"endEditPoint",event:t,data:x._shape,index:R}),S&&S.endInteraction()):x._edge&&R>=0?(x.fi({kind:"endEditPoint",event:t,data:x._edge,index:R}),S&&S.endInteraction()):x.$23l&&x.$40l&&(x.fi({kind:"endEditRotation",event:t}),S&&S.endInteraction())},handleWindowTouchEnd:function(n){this.handleWindowMouseUp(n)},handleWindowMouseUp:function(G){var k=this,q=k.gv,V=q.dm(),M=V.getHistoryManager(),C=k._shape,X=k._edge,o=k.$13l,y=k.$40l,D=k.$9l,m=k.$10l,b=k.$67l;if((C||X)&&o>=0&&D>=0){var v,u;if(C){var d=C.p(),H=C.getRotation();v=C.getPoints(),u=v.get(D),zb(C,d,H,o,u,!1)}else if(v=pd(q.getDataUI(X),X.s("edge.points"),!0),u=v.get(D),0===o){var N=v.get(0);X.s("edge.source.offset.x",u.x-N.x),X.s("edge.source.offset.y",u.y-N.y)}else if(o===v.size()-1){var L=v.get(v.size()-1);X.s("edge.target.offset.x",u.x-L.x),X.s("edge.target.offset.y",u.y-L.y)}else"points"===X.s("edge.type")&&(v.set(o,u),X.s("edge.points",Qf(v)))}k.$47l(G);var i=k.$73l;1===b?(M&&M.beginInteraction(),i?q.sm().each(function(X){if(X.setHost&&q.isHelperEditable(X,"host")){X.setHost(i);var T=k.$75l,o=k.$74l;T&&(X.s("attach.row.index",T.rowIndex),X.s("attach.column.index",T.columnIndex)),o&&(X.s("attach.index",o.attachIndex),X.s("attach.offset",o.attachOffset),X.s("attach.offset.relative",!1),X.s("attach.offset.opposite",!1))
}}):q.sm().each(function(z){z.setHost&&q.isHelperEditable(z,"host")&&(z.setHost(E),z.s("attach.row.index",P),z.s("attach.column.index",P),z.s("attach.index",P),z.s("attach.offset",P),z.s("attach.offset.relative",!1),z.s("attach.offset.opposite",!1))}),M&&M.endInteraction()):2===b?(M&&M.beginInteraction(),i?q.sm().each(function(e){e.setParent&&q.isHelperEditable(e,"parent")&&e.setParent(i)}):q.sm().each(function(T){T.setParent&&q.isHelperEditable(T,"parent")&&T.setParent(E)}),M&&M.endInteraction()):3===b?i&&(M&&M.beginInteraction(),q.sm().each(function(n){if(q.isHelperEditable(n,"edge")&&n instanceof Y&&i instanceof Y){var c=new U.Edge;V.add(c),c.setSource(n),c.setTarget(i),k.onEdgeCreated&&k.onEdgeCreated(G,c)}}),M&&M.endInteraction()):(5===b||6===b)&&i&&(M&&M.beginInteraction(),q.sm().each(function(V){V instanceof A&&i instanceof Y&&(5===b&&q.isHelperEditable(V,"source")?V.setSource(i):6===b&&q.isHelperEditable(V,"source")&&V.setTarget(i))}),M&&M.endInteraction()),(m||y)&&k.$43l(!0),r?(k.clear(),delete k.$64l,k._68I||k.$43l()):(k.handle_mousemove(G,!0),b&&!k._68I&&k.$43l())},handleWindowTouchMove:function(g){this.handleWindowMouseMove(g)},handleWindowMouseMove:function(K){this._78I(K)},handle_mousemove:function(m,O,b){if(!this._pause){if(!b){var Z=r?zh(m):m;this.$61l={clientX:Z.clientX,clientY:Z.clientY}}if(O===!0||!D()){var B=this,o=B.gv,M=!1,V=E;B.clear(),o.sm().size()>0&&(V=o.lp(b?B.$61l:m),M=B._79I(m,V)),M&&(o._editing=1),B.$12l!==B.$65l&&(B.$65l=B.$12l,B.setCursor(B.$12l)),B.$40l!==B.$64l&&(B.$64l=B.$40l,B._68I||B.$43l()),B._hoverSegmentIndex!==B.$66l&&(B.$66l=B._hoverSegmentIndex,B._68I||B.$43l())}}},_78I:function(x){this.autoScroll(x);var C=this,o=C.gv,s=o.lp(x),w=o.getZoom(),X=C.$13l;if((C._shape||C._edge)&&X>=0){var y,$,Z,U=C._shape,H=C._edge,L=C.$24l,J=o.getPointSnapSpacing(),V=function(C,G){return J==E||isNaN(J)?{x:C,y:G}:{x:W(C/J)*J,y:W(G/J)*J}};if(U){y=U.getPoints();var t=U.p(),G=U.getRotation(),b=0;$=Tp(t,s.x-t.x,s.y-t.y,-G),zb(U,t,G,X,s,!0,L,V),C.fi({kind:"betweenEditPoint",event:x,data:U,index:X})}else if(H){y=pd(o.getDataUI(H),H.s("edge.points"),!0),s.x-=L.x,s.y-=L.y,$=s;var P,R;if(0===X){var q=y.get(0);P=s.x-q.x,R=s.y-q.y,Z=V(P,R),H.s("edge.source.offset.x",Z.x),H.s("edge.source.offset.y",Z.y)}else if(X===y.size()-1){var M=y.get(y.size()-1);P=s.x-M.x,R=s.y-M.y,Z=V(P,R),H.s("edge.target.offset.x",Z.x),H.s("edge.target.offset.y",Z.y)}else"points"===H.s("edge.type")&&(Z=V(s.x,s.y),Z.e=y.get(X).e,y.set(X,Z),H.s("edge.points",Qf(y)));C.fi({kind:"betweenEditPoint",event:x,data:H,index:X})}if(delete C.$9l,o.isSnapPoint(U)||o.isSnapPoint(H))for(b=0;b<y.size();b++)if(b!==X){var u=y.get(b);if(I(u,$)<o.getEditPointSize()/w){C.$9l=b;break}}}else if(C.$10l){var L=C.$24l;s.x-=L.x,s.y-=L.y;var _=o.sm().getSelection(),m=C.$1l,k=C.$7l,r=C.$10l,j=C.$4l,v=C.$2l,z=o.getEditRectPadding()/w,O=2*z,S=o.getSnapSpacing(),K=S!=E&&!isNaN(S),d=xp(v,s,r,k,2*z,o.getResizeMode(),K,!0),F=C.$6l;if(K){var n=d.width-O,T=d.height-O,Q=W(n/S)*S,D=W(T/S)*S,h=Q-n,N=D-T;("west"===r||"northwest"===r||"southwest"===r)&&(h=-h),("north"===r||"northwest"===r||"northeast"===r)&&(N=-N),d=xp(v,s,r,k,2*z,o.getResizeMode(),K,!1,h,N)}C.$8l=d,F.x=d.x+z,F.y=d.y+z,F.width=d.width-O,F.height=d.height-O;var Bk=d.x+d.width/2,Me=d.y+d.height/2,Ii=F.x,eo=F.y,Ud=F.width/j.width,Wb=F.height/j.height;_.each(function(K){if(K instanceof Y&&o.isEditable(K)&&o.isRectEditable(K)){var $=m[K.getId()],U=C.$3l[K.getId()],x={x:$.x+$.width/2,y:$.y+$.height/2},J=0,A=0,y=r,W=180*a(k-K.getRotation())/c;"northeast"===r?W>=315||45>W?(J=$.width*Ud+$.x,A=$.height*(1-Wb)+$.y,y="northeast"):W>=45&&135>W?(J=$.width*(1-Wb)+$.x,A=$.height*(1-Ud)+$.y,y="northwest"):W>=135&&225>W?(J=$.width*(1-Ud)+$.x,A=$.height*Wb+$.y,y="southwest"):(J=$.width*Wb+$.x,A=$.height*Ud+$.y,y="southeast"):"north"===r?W>=315||45>W?(A=$.height*(1-Wb)+$.y,y="north"):W>=45&&135>W?(J=$.width*(1-Wb)+$.x,y="west"):W>=135&&225>W?(A=$.height*Wb+$.y,y="south"):(J=$.width*Wb+$.x,y="east"):"northwest"===r?W>=315||45>W?(J=$.width*(1-Ud)+$.x,A=$.height*(1-Wb)+$.y,y="northwest"):W>=45&&135>W?(J=$.width*(1-Wb)+$.x,A=$.height*Ud+$.y,y="southwest"):W>=135&&225>W?(J=$.width*Ud+$.x,A=$.height*Wb+$.y,y="southeast"):(J=$.width*Wb+$.x,A=$.height*(1-Ud)+$.y,y="northeast"):"west"===r?W>=315||45>W?(J=$.width*(1-Ud)+$.x,y="west"):W>=45&&135>W?(A=$.height*Ud+$.y,y="south"):W>=135&&225>W?(J=$.width*Ud+$.x,y="east"):(A=$.height*(1-Ud)+$.y,y="north"):"southwest"===r?W>=315||45>W?(J=$.width*(1-Ud)+$.x,A=$.height*Wb+$.y,y="southwest"):W>=45&&135>W?(J=$.width*Wb+$.x,A=$.height*Ud+$.y,y="southeast"):W>=135&&225>W?(J=$.width*Ud+$.x,A=$.height*(1-Wb)+$.y,y="northeast"):(J=$.width*(1-Wb)+$.x,A=$.height*(1-Ud)+$.y,y="northwest"):"east"===r?W>=315||45>W?(J=$.width*Ud+$.x,y="east"):W>=45&&135>W?(A=$.height*(1-Ud)+$.y,y="north"):W>=135&&225>W?(J=$.width*(1-Ud)+$.x,y="west"):(A=$.height*Ud+$.y,y="south"):"south"===r?W>=315||45>W?(A=$.height*Wb+$.y,y="south"):W>=45&&135>W?(J=$.width*Wb+$.x,y="east"):W>=135&&225>W?(A=$.height*(1-Wb)+$.y,y="north"):(J=$.width*(1-Wb)+$.x,y="west"):"southeast"===r&&(W>=315||45>W?(J=$.width*Ud+$.x,A=$.height*Wb+$.y,y="southeast"):W>=45&&135>W?(J=$.width*Wb+$.x,A=$.height*(1-Ud)+$.y,y="northeast"):W>=135&&225>W?(J=$.width*(1-Ud)+$.x,A=$.height*(1-Wb)+$.y,y="northwest"):(J=$.width*(1-Wb)+$.x,A=$.height*Ud+$.y,y="southwest"));var O=Tp(x,J-x.x,A-x.y,K.getRotation());Ak(K,$,y,{x:O.x,y:O.y});var Q=Ii+F.width*U.x,B=eo+F.height*U.y,t={x:Q,y:B};t=Tp({x:Bk,y:Me},t.x-Bk,t.y-Me,k),K.p(t.x,t.y)}}),C.fi({kind:"betweenEditRect",event:x,direction:r})}else if(C.$23l&&C.$40l){var Yj=C.$8l,ff=Yj.width,Ok=Yj.height,t={x:Yj.x+ff/2,y:Yj.y+Ok/2},L=C.$24l,as=C.$23l,Sb=as.x/w-t.x,Wi=as.y/w-t.y,vc=B(Sb*Sb+Wi*Wi),nb=Math.asin(L.x/vc),Uj=o.sm().getSelection(),qo=f+i(s.y-t.y,s.x-t.x)-nb,Fj=o.getSnapAngle(),qo=W(qo/Fj)*Fj;0>qo&&(qo+=g);var lk=qo-C.$7l,Gh=[t.x,0,t.y];Uj.each(function(i){if(o.isEditable(i)&&o.isRotationEditable(i)&&o.isVisible(i)){var t=qi(i.p3(),Gh),S=jr();hh(S,-lk),i.setRotation(i.getRotation()+lk),ln(t,S),i.p3(Gh[0]+t[0],Gh[1]+t[1],Gh[2]+t[2])}}),C.$7l=qo,C.fi({kind:"betweenEditRotation",event:x})}else if([1,2,3,5,6].indexOf(C.$67l)>=0)C.$72l=x,C.$78l||(C.$78l=1,l(function(){p.isDragging()&&C.$43l(),delete C.$78l},12));else if(7===C.$67l){if(C.$87l instanceof e){var U=C.$87l,_h=C.$88l,ip=p.clone(U.getPoints().get(_h)),fe=s.y-ip.y;ip.e||(ip.e=0),C.$92l||(C.$92l=ip.e),ip.e=C.$92l-fe,U.setPoint(_h,ip)}else if(C.$87l instanceof A){var H=C.$87l,_h=C.$88l,y=pd(o.getDataUI(H),H.s("edge.points")),ip=y.get(_h),fe=s.y-ip.y;ip.e||(ip.e=0),C.$92l||(C.$92l=ip.e),ip.e=C.$92l-fe,y.set(_h,ip),H.s("edge.points",Qf(y))}}else if(8===C.$67l){var Uj=o.sm().getSelection(),$m=C.$93l;$m||($m=C.$93l={}),Uj.each(function(G){if(G.p3){var _=G.p3(),M=$m[G.getId()];M==E&&(M=$m[G.getId()]=_[1]),G.p3([_[0],M-(s.y-C.$90l.y/w),_[2]])}})}else if(9===C.$67l){var Uj=o.sm().getSelection(),wd=C.$94l;wd||(wd=C.$94l={}),Uj.each(function(I){if(I.s3){var L=I.s3(),N=wd[I.getId()];N==E&&(N=wd[I.getId()]=L[1]);var m=N-(s.y-C.$91l.y/w);0>m&&(m=.01),I.s3([L[0],m,L[2]])}})}},$79l:function(M,c){var A=this,Z=A.gv,K=Z.getZoom(),g=Z.getEditHelperSize(),m=M.x/K,W=M.y/K,Q=g/K,d=Q/2;return j({x:m-d,y:W-d,width:Q,height:Q},c)?!0:void 0},_79I:function(b,t){var s=this,Q=s.gv,O=Q.getZoom(),a=Q.getEditPointSize(),N=a/O,y=N/2;if(s.$16l){var r,$=s.$16l,w=$[3].x-$[7].x,f=$[3].y-$[7].y,V=B(w*w+f*f),R=$[1].x-$[5].x,m=$[1].y-$[5].y,E=B(R*R+m*m),C={x:t.x*O,y:t.y*O};if(s._80I(C,0,$[0],"northwest",V,E)||s._80I(C,1,$[1],"north",V,E)||s._80I(C,2,$[2],"northeast",V,E)||s._80I(C,7,$[7],"west",V,E)||s._80I(C,3,$[3],"east",V,E)||s._80I(C,6,$[6],"southwest",V,E)||s._80I(C,5,$[5],"south",V,E)||s._80I(C,4,$[4],"southeast",V,E))return!0}if(s.$23l){var x=s.$23l,q=x.x/O,v=x.y/O;if(j({x:q-y,y:v-y,width:N,height:N},t))return s.$40l=1,s.$12l="crosshair",!0}if(s.$68l&&s.$79l(s.$68l,t))return s.$67l=1,s.$12l="crosshair",!0;if(s.$69l&&s.$79l(s.$69l,t))return s.$67l=2,s.$12l="crosshair",!0;if(s.$70l&&s.$79l(s.$70l,t))return s.$67l=3,s.$12l="crosshair",!0;if(s.$71l&&s.$79l(s.$71l,t))return s.$67l=4,s.$12l="crosshair",!0;if(s.$82l&&s.$79l(s.$82l,t))return s.$67l=5,s.$12l="crosshair",!0;if(s.$83l&&s.$79l(s.$83l,t))return s.$67l=6,s.$12l="crosshair",!0;if(s._pointElevationHelperPoint&&s.$79l(s._pointElevationHelperPoint,t))return s.$67l=7,s.$12l="crosshair",!0;if(s.$90l&&s.$79l(s.$90l,t))return s.$67l=8,s.$12l="crosshair",!0;if(s.$91l&&s.$79l(s.$91l,t))return s.$67l=9,s.$12l="crosshair",!0;for(var K=s.$46l(b),n=0;n<K.length;n++){var r,d,u=K[n],M=Q.getDataUI(u);if(M&&M._55O){var i=M._55O;if(i._43O&&u instanceof A){if(r=u.s("edge.points"),r=pd(M,r),d=u.s("edge.segments"),d||(d=gl(r)),s.$42l(u,t,r._as,d,"edge"))return!0;"points"===u.s("edge.type")&&s.$41l(u,t,r._as,d,"edge")}if(i._43O&&u instanceof e&&i.$15l&&i.$15l.length===u.getPoints().size()){if(r=i.$15l,d=u.getSegments(),d||(d=gl(r)),s.$42l(u,t,r,d,"shape"))return!0;s.$41l(u,t,r,d,"shape")}}}return!1},_80I:function(i,C,E,s,M,n){var N=this,D=N.gv,h=D.getEditPointSize(),m=h/2,F=D.sm(),t=D.isDirectionEditable;if(t&&1===F.size()){var Z=F.ld();if(t=t.bind(D),Z instanceof Y){if(!t(Z,s))return!1;if("east"===s){if(t(Z,"northeast")&&t(Z,"southeast")&&2*h>=n)return!1}else if("west"===s){if(t(Z,"northwest")&&t(Z,"southwest")&&2*h>=n)return!1}else if("north"===s){if(t(Z,"northwest")&&t(Z,"northeast")&&2*h>=M)return!1}else if("south"===s&&t(Z,"southwest")&&t(Z,"southeast")&&2*h>=M)return!1}}else{if(2*h>=M&&("north"===s||"south"===s))return!1;if(2*h>=n&&("east"===s||"west"===s))return!1}if(j({x:E.x-m,y:E.y-m,width:h,height:h},i)){if(N.$10l!==s){var z=180*N.$7l/c,v="";z>=337.5||22.5>z?v="north":z>=22.5&&67.5>z?v="northeast":z>=67.5&&112.5>z?v="east":z>=112.5&&157.5>z?v="southeast":z>=157.5&&202.5>z?v="south":z>=202.5&&247.5>z?v="southwest":z>=247.5&&292.5>z?v="west":z>=292.5&&337.5>z&&(v="northwest");var U=he.indexOf(v),v=he[C-(1-U)+8];switch(v){case"northwest":N.$12l="nwse-resize";break;case"northeast":N.$12l="nesw-resize";break;case"southwest":N.$12l="nesw-resize";break;case"southeast":N.$12l="nwse-resize";break;case"north":N.$12l="ns-resize";break;case"east":N.$12l="ew-resize";break;case"south":N.$12l="ns-resize";break;case"west":N.$12l="ew-resize"}N.$10l=s}return!0}return!1},$42l:function(N,t,c,i,b){var p,X=this,T=X.gv,n=T.getEditPointSize(),_=n/T.getZoom(),v=-1,y={x:t.x,y:t.y,width:0,height:0},U=function(Q){"shape"===b?X._shape=N:X._edge=N,X._removePointIndex=Q},J=function(Q){"shape"===b?X._shape=N:X._edge=N,X.$13l=Q,X.$12l="crosshair"};for(z(y,_/2),v=c.length-1,p=i.size()-1;p>=0;p--){var Q=i.get(p);if(1===Q||2===Q)v-=1;else if(3===Q){var B=c[v-1];if(j(y,B))return J(v-1),!0;v-=2}else if(4===Q){var A=c[v-1],q=c[v-2];if(j(y,A))return J(v-1),!0;if(j(y,q))return J(v-2),!0;v-=3}}for(v=c.length-1,p=i.size()-1;p>=0;p--){var Q=i.get(p),K=c[v];if(j(y,K))return U(v),J(v),!0;1===Q||2===Q?v-=1:3===Q?v-=2:4===Q&&(v-=3)}return!1},$41l:function(P,p,s,N,r){var k=this,G=k.gv,n=-1,S=0,q={x:p.x,y:p.y,width:0,height:0},f=function(q,I){k._hoverSegmentIndex=I,k._lp=p,"shape"===r?k._shape=P:k._edge=P};for(z(q,G.getSegmentHoverWidth()/2/G.getZoom()),P instanceof e&&P.isClosePath()&&N.indexOf(5)<0&&(N=new M(N._as),N.add(5));S<N.size();S++){var H=N.get(S);if(1===H){var D=s[n],J=s[n+1];if(D){var I=cn(new Wq(D.x,D.y),new Wq(J.x,J.y),new Wq(q.x,q.y),new Wq(q.x+q.width,q.y+q.height));if(I.$62l===K&&I.points.length>0)return f(I,S),!0}n+=1}else if(2===H){var D=s[n],J=s[n+1],I=cn(new Wq(D.x,D.y),new Wq(J.x,J.y),new Wq(q.x,q.y),new Wq(q.x+q.width,q.y+q.height));if(I.$62l===K&&I.points.length>0)return f(I,S),!0;n+=1}else if(3===H){var D=s[n],c=s[n+1],Y=s[n+2],I=fk(new Wq(D.x,D.y),new Wq(c.x,c.y),new Wq(Y.x,Y.y),new Wq(q.x,q.y),new Wq(q.x+q.width,q.y+q.height));if(I.$62l===K)return f(I,S),!0;n+=2}else if(4===H){var D=s[n],u=s[n+1],l=s[n+2],Y=s[n+3],I=mq(new Wq(D.x,D.y),new Wq(u.x,u.y),new Wq(l.x,l.y),new Wq(Y.x,Y.y),new Wq(q.x,q.y),new Wq(q.x+q.width,q.y+q.height));if(I.$62l===K)return f(I,S),!0;n+=3}else if(5===H){var D=s[n],J=s[0];if(D){var I=cn(new Wq(D.x,D.y),new Wq(J.x,J.y),new Wq(q.x,q.y),new Wq(q.x+q.width,q.y+q.height));if(I.$62l===K&&I.points.length>0)return f(I,S),!0}}}return!1},addShapePoint:function(g,p,W){var j=this,o=j.gv,I=o.dm(),G=I.getHistoryManager();if(G&&G.beginInteraction(),0===arguments.length&&(g=j._shape||j._edge,p=j._hoverSegmentIndex,W=j._lp),g instanceof e||g instanceof A){var c=Ne(g,o.getDataUI(g),p);if(!isNaN(p)&&W&&!isNaN(c)){var T=W;if(g instanceof e){var O=g.p(),q=g.getRotation(),k=g.toSegments();k||(k=gl(g.getPoints())),g.isClosePath()&&k.indexOf(5)<0&&(k=new M(k._as),k.add(5));var n=k.get(p),t="addPoint",P="removePointAt";if(2===n||1===n){var R={x:T.x,y:T.y};k.add(n,p),R=Tp(O,R.x-O.x,R.y-O.y,-q),g[t](R,c+1)}else if(3===n){var E=g.getPoints(),m=E.get(c),$=E.get(c+2),R={x:T.x,y:T.y};R=Tp(O,R.x-O.x,R.y-O.y,-q);var F=gs(m,R),U=gs(R,$);k.removeAt(p),k.add(3,p),k.add(3,p),g.setPoint(c+1,R),g[t](U,c+2),g[t](F,c+1)}else if(4===n){var E=g.getPoints(),m=E.get(c),$=E.get(c+3),R={x:T.x,y:T.y};R=Tp(O,R.x-O.x,R.y-O.y,-q);var F=Wk(m,R),U=Tf(m,R),h=Wk(R,$),i=Tf(R,$);k.removeAt(p),k.add(4,p),k.add(4,p),g[P](c+1),g[P](c+1),g[t](R,c+1),g[t](i,c+2),g[t](h,c+2),g[t](U,c+1),g[t](F,c+1)}else if(5===n){var R={x:T.x,y:T.y};k.add(2,p),R=Tp(O,R.x-O.x,R.y-O.y,-q),g[t](R,c+1)}g.isClosePath()&&k.remove(5),g.setSegments(k);var X=g.getWidth(),V=g.getHeight(),u=g.p().x-X/2,f=g.p().y-V/2;u-=O.x,f-=O.y;var z=fh(g,{x:u,y:f,width:X,height:V},q,O);g.p(z.x,z.y)}else if(g instanceof A){if("points"!==g.s("edge.type"))return G&&G.endInteraction(),void 0;var E=g.s("edge.points");k=g.s("edge.segments"),E=pd(o.getDataUI(g),E),k||(k=gl(E)),k=new M(k._as.slice(0)),E=new M(E._as.slice(0));var n=k.get(p);if(2===n||1===n){var R={x:T.x,y:T.y};k.add(n,p),E.add(R,c+1)}else if(3===n){var m=E.get(c),$=E.get(c+2),R={x:T.x,y:T.y},F=gs(m,R),U=gs(R,$);k.removeAt(p),k.add(3,p),k.add(3,p),E.set(c+1,R),E.add(U,c+2),E.add(F,c+1)}else if(4===n){var m=E.get(c),$=E.get(c+3),R={x:T.x,y:T.y},F=Wk(m,R),U=Tf(m,R),h=Wk(R,$),i=Tf(R,$);k.removeAt(p),k.add(4,p),k.add(4,p),E.removeAt(c+1),E.removeAt(c+1),E.add(R,c+1),E.add(i,c+2),E.add(h,c+2),E.add(U,c+1),E.add(F,c+1)}g.s("edge.points",Qf(E)),g.s("edge.segments",k)}}}G&&G.endInteraction()},removeShapePoint:function(S,i){var z=this,a="removeAt",C=z.gv,I=C.dm(),Y=I.getHistoryManager();if(Y&&Y.beginInteraction(),0===arguments.length&&(S=z._shape||z._edge,i=z._removePointIndex),i>=0&&(S instanceof e||S instanceof A)){var h=Fe(S,z.gv.getDataUI(S),i),J=i;if(S instanceof e){var E=S.p(),G=S.toSegments();G||(G=gl(S.getPoints()));var N=G.get(h),p="removePointAt";if(1===N&&0===J)if(S.getPoints().size()>1){var d=G.get(h+1);G[a](h+1),3===d?S[p](J+1):4===d&&(S[p](J+2),S[p](J+1)),S[p](J)}else S.dm().remove(S);else 2===N||1===N?(G[a](h),S[p](J)):3===N?(G[a](h),S[p](J),S[p](J-1)):4===N&&(G[a](h),S[p](J),S[p](J-1),S[p](J-2));S.setSegments(G);var u=S.getWidth(),v=S.getHeight(),W=S.p().x-u/2,L=S.p().y-v/2;W-=E.x,L-=E.y;var x=fh(S,{x:W,y:L,width:u,height:v},S.getRotation(),E);S.p(x.x,x.y)}else if(S instanceof A){if("points"!==S.s("edge.type"))return Y&&Y.endInteraction(),void 0;var R=S.s("edge.points");if(G=S.s("edge.segments"),R&&(R=pd(z.gv.getDataUI(S),R),G||(G=gl(R))),0===i||i===R.size()-1)return Y&&Y.endInteraction(),void 0;G=new M(G._as.slice(0)),R=new M(R._as.slice(0));var N=G.get(h);2===N||1===N?(G[a](h),R[a](J)):3===N?(G[a](h),R[a](J),R[a](J-1)):4===N&&(G[a](h),R[a](J),R[a](J-1),R[a](J-2)),S.s("edge.segments",G),S.s("edge.points",Qf(R))}}Y&&Y.endInteraction()},changeShapeSegment:function(J,G,s){var O=this,K=O.gv,g=K.dm(),c=g.getHistoryManager();if(c&&c.beginInteraction(),1!==arguments.length||isNaN(J)||(s=J,J=O._shape||O._edge,G=O._hoverSegmentIndex),J instanceof e||J instanceof A){var p=Ne(J,O.gv.getDataUI(J),G);if(!isNaN(G)&&!isNaN(p))if(J instanceof e){var x=J.p(),Z=J.toSegments();Z||(Z=gl(J.getPoints()));var V=Z.get(G),n=J.toPoints();if(1===s||2===s)1===V||2===V?Z.set(G,s):3===V?(Z.set(G,s),n.removeAt(p+1)):4===V&&(Z.set(G,s),n.removeAt(p+1),n.removeAt(p+1));else if(3===s){var t=function(){var F=n.get(p),g=n.get(p+1),L=gs(F,g);Z.set(G,3),n.add(L,p+1)};2===V||1===V?t():4===V&&(n.removeAt(p+1),n.removeAt(p+1),t())}else if(4===s){var W=function(){var H=n.get(p),m=n.get(p+1),U=Wk(H,m),_=Tf(H,m);Z.set(G,4),n.add(U,p+1),n.add(_,p+2)};2===V||1===V?W():3===V&&(n.removeAt(p+1),W())}J.setSegments(Z),J.setPoints(n);var i=J.getWidth(),q=J.getHeight(),w=J.p().x-i/2,E=J.p().y-q/2;w-=x.x,E-=x.y;var d=new fh(J,{x:w,y:E,width:i,height:q},J.getRotation(),x);J.p(d.x,d.y)}else if(J instanceof A){if("points"!==J.s("edge.type"))return c&&c.endInteraction(),void 0;var n=J.s("edge.points");Z=J.s("edge.segments"),n&&(n=pd(O.gv.getDataUI(J),n),Z||(Z=gl(n))),Z=new M(Z._as.slice(0)),n=new M(n._as.slice(0));var V=Z.get(G);if(1===s||2===s)1===V||2===V?Z.set(G,s):3===V?(Z.set(G,s),n.removeAt(p+1)):4===V&&(Z.set(G,s),n.removeAt(p+1),n.removeAt(p+1));else if(3===s){var t=function(){var V=n.get(p),$=n.get(p+1),c=gs(V,$);Z.set(G,3),n.add(c,p+1)};2===V||1===V?t():4===V&&(n.removeAt(p+1),n.removeAt(p+1),t())}else if(4===s){var W=function(){var U=n.get(p),N=n.get(p+1),z=Wk(U,N),b=Tf(U,N);Z.set(G,4),n.add(z,p+1),n.add(b,p+2)};2===V||1===V?W():3===V&&(n.removeAt(p+1),W())}J.s("edge.points",Qf(n)),J.s("edge.segments",Z)}}c&&c.endInteraction()},getDefaultSegments:function(S){var C=this.gv,B=C.getDataUI(S);if(S instanceof A){var b=S.s("edge.points");return b=pd(B,b),gl(b)}if(S instanceof e){var b=S.getPoints(),y=S.getSegments();return y&&y.size()>0?y:gl(b)}},$43l:function(d){var G=this;d&&(G.$5l=1),G._68I=1,G._42()},_42:function(){var L=this;if(L._68I){delete L._68I;var s=L.gv,h=L.$5l,t=s.getZoom(),k=s.getEditPointSize(),c=k/2,r=new M,O=L._view,K=L._edge,V=L._shape,v=O.getContext("2d"),Q=s.tx(),W=s.ty(),a=E,d=s.getEditPointBackground(),R=s.getControlPointBackground(),G=s.getControlPointBorderColor(),T=s.getEditPointBorderColor(),N=s.getEditRectBorderColor(),l=s.getDirectionLineColor(),f=s.getSegmentHoverColor(),n=s.getSnapPointBorderColor(),X=s.getJoinPointBackground(),D=s.getJoinPointBorderColor(),H=s.getSegmentHoverWidth(),S=[5,5],P=s.getEditRectBorderStyle();He(s,function(f){s.isSelected(f)&&s.isVisible(f)&&r.add(f)}),v.clearRect(0,0,m(O.width),m(O.height)),v.save(),x.translateAndScale(v,Q,W,1);var u=E,i={x:0,y:0,width:0,height:0},w=0,_=0,Z=0,j=0,I=0,C=0,El=0,Vq=0,Mr=0,Mc=0,Uc=[];if(h?(delete L.$6l,delete L.$8l,delete L.$7l,delete L.$16l,delete L.$23l):(u=L.$6l,a=L.$7l),delete L.$68l,delete L.$69l,delete L.$71l,delete L.$70l,delete L.$82l,delete L.$83l,delete L._pointElevationHelperPoint,delete L.$90l,delete L.$91l,delete L.$75l,delete L.$74l,r.each(function(G){var r=s.getDataUI(G);if(r){var k=r._55O;if(s.isEditable(G))k._56O&&G instanceof Y&&_++,Uc.push(G),k._42O&&G instanceof Y&&w++,s.isHelperEditable(G,"host")&&j++,s.isHelperEditable(G,"parent")&&Z++,s.isHelperEditable(G,"remove")&&I++,s.isHelperEditable(G,"edge")&&C++,s.isHelperEditable(G,"source")&&El++,s.isHelperEditable(G,"target")&&Vq++,s.isHelperEditable(G,"elevation")&&Mr++,s.isHelperEditable(G,"tall")&&Mc++;else if(G instanceof y&&G.isExpanded()){var V=!0,c=s.getEditableFunc();c&&(V=c(G)),V&&(s.isHelperEditable(G,"host")&&j++,s.isHelperEditable(G,"parent")&&Z++,s.isHelperEditable(G,"remove")&&I++,s.isHelperEditable(G,"edge")&&C++,s.isHelperEditable(G,"source")&&El++,s.isHelperEditable(G,"target")&&Vq++,s.isHelperEditable(G,"elevation")&&Mr++,s.isHelperEditable(G,"tall")&&Mc++,Uc.push(G))}}}),v.beginPath(),v.lineWidth=1,v.strokeStyle=s.getNodeBorderColor(),Uc.forEach(function(z){var C=s.getDataUI(z),K=C._55O;if(h)if(a==E&&(a=z instanceof A?0:z instanceof y&&z.isExpanded()?0:z.getRotation(),L.$7l=a),u==E){var f,q,d;if(z instanceof y&&z.isExpanded()||z instanceof A){var V=s.getDataUIBounds(z);q=V.width,d=V.height,f={x:V.x+q/2,y:V.y+d/2}}else f=z.p(),q=z.getWidth(),d=z.getHeight();u={x:f.x,y:f.y,width:0,height:0},i.x=f.x-q/2,i.y=f.y-d/2,i.width=q,i.height=d,u=F(u,i)}else{var f,q,d,N,Z=u.x+u.width/2,X=u.y+u.height/2,n={x:Z,y:X};if(z instanceof y&&z.isExpanded()||z instanceof A){N=0;var V=s.getDataUIBounds(z);q=V.width,d=V.height,f={x:V.x+q/2,y:V.y+d/2}}else f=z.p(),q=z.getWidth(),d=z.getHeight(),N=z.getRotation();var Q={x:f.x-q/2,y:f.y-d/2,width:q,height:d},W={x:Q.x,y:Q.y},x={x:Q.x+Q.width,y:Q.y},c={x:Q.x,y:Q.y+Q.height},R={x:Q.x+Q.width,y:Q.y+Q.height},W=Tp(f,W.x-f.x,W.y-f.y,N),c=Tp(f,c.x-f.x,c.y-f.y,N),R=Tp(f,R.x-f.x,R.y-f.y,N),x=Tp(f,x.x-f.x,x.y-f.y,N),j=-a,T=Tp(n,W.x-n.x,W.y-n.y,j),r=Tp(n,x.x-n.x,x.y-n.y,j),l=Tp(n,c.x-n.x,c.y-n.y,j),P=Tp(n,R.x-n.x,R.y-n.y,j),U=J([T,r,l,P]);u=F(u,U),u.x-=Z,u.y-=X;var D=fh(E,u,a,n);u.x=D.x-u.width/2,u.y=D.y-u.height/2}if(w>1&&s.isEditable(z)&&s.isRectEditable(z)&&z instanceof Y){var G=z.getRect(),H=K.$45l,g=Yj(H[0],t),p=Yj(H[2],t),b=Yj(H[4],t),e=Yj(H[6],t);z.getRotation()?(v.moveTo(g.x,g.y),v.lineTo(p.x,p.y),v.lineTo(b.x,b.y),v.lineTo(e.x,e.y),v.lineTo(g.x,g.y)):v.rect(G.x*t,G.y*t,G.width*t,G.height*t)}}),v.stroke(),r.each(function(W){var z=s.getDataUI(W);if(z){var r,Q,Y=z._55O,b=z._78o;if(Y&&Y._43O&&W instanceof e?(r=Y.$15l,Q=W.getSegments(),Q||(Q=gl(r)),W.isClosePath()&&Q.indexOf(5)<0&&(Q=new M(Q._as),Q.add(5))):Y&&b&&Y._43O&&(r=W.s("edge.points"),Q=W.s("edge.segments"),r=pd(z,r),Q||(Q=gl(r)),r&&(r=r._as)),r&&Q){var A=0,q=Q.size(),u=L._hoverSegmentIndex;r=r.slice(0);for(var T=0;T<r.length;T++)r[T]=Yj(r[T],t);v.beginPath(),v.strokeStyle=l,v.lineWidth=1,A=0;for(var T=0;q>T;T++){var J=Q.get(T);if(1===J||2===J)A++;else if(3===J){var N=r[A-1],B=r[A],I=r[A+1];v.moveTo(N.x,N.y),v.lineTo(B.x,B.y),v.lineTo(I.x,I.y),A+=2}else if(4===J){var N=r[A-1],j=r[A],_=r[A+1],I=r[A+2];v.moveTo(N.x,N.y),v.lineTo(j.x,j.y),v.moveTo(_.x,_.y),v.lineTo(I.x,I.y),A+=3}}if(v.stroke(),V===W||K===W&&"points"===K.s("edge.type")){v.beginPath(),A=0,v.strokeStyle=f,v.lineWidth=H;for(var T=0;q>T;T++){var J=Q.get(T);if(1===J||2===J){if(u===T){var N=r[A-1],I=r[A];v.moveTo(N.x,N.y),v.lineTo(I.x,I.y);break}A++}else if(3===J){if(u===T){var N=r[A-1],B=r[A],I=r[A+1];v.moveTo(N.x,N.y),v.quadraticCurveTo(B.x,B.y,I.x,I.y);break}A+=2}else if(4===J){if(u===T){var N=r[A-1],j=r[A],_=r[A+1],I=r[A+2];v.moveTo(N.x,N.y),v.bezierCurveTo(j.x,j.y,_.x,_.y,I.x,I.y);break}A+=3}else if(5===J&&u===T){var N=r[A-1],I=r[0];v.moveTo(N.x,N.y),v.lineTo(I.x,I.y);break}}v.stroke()}v.beginPath(),A=0,v.strokeStyle=D,v.lineWidth=1,v.fillStyle=X;for(var T=0;q>T;T++){var J=Q.get(T);if(1===J||2===J){var I=r[A];v.moveTo(I.x+c,I.y),v.arc(I.x,I.y,c,0,g,!0),A++}else if(3===J){var I=r[A+1];v.moveTo(I.x+c,I.y),v.arc(I.x,I.y,c,0,g,!0),A+=2}else if(4===J){var I=r[A+2];v.moveTo(I.x+c,I.y),v.arc(I.x,I.y,c,0,g,!0),A+=3}}v.fill(),v.stroke(),v.beginPath(),A=0,v.strokeStyle=G,v.lineWidth=1,v.fillStyle=R;for(var T=0;q>T;T++){var J=Q.get(T);if(1===J||2===J)A++;else if(3===J){var B=r[A];v.moveTo(B.x+c,B.y),v.arc(B.x,B.y,c,0,g,!0),A+=2}else if(4===J){var j=r[A],_=r[A+1];v.moveTo(j.x+c,j.y),v.arc(j.x,j.y,c,0,g,!0),v.moveTo(_.x+c,_.y),v.arc(_.x,_.y,c,0,g,!0),A+=3}}if(v.fill(),v.stroke(),v.beginPath(),A=0,v.strokeStyle=n,v.lineWidth=2,(V===W||K===W)&&L.$9l!=E){var I=r[L.$9l];v.moveTo(I.x+c,I.y),v.arc(I.x,I.y,c,0,g,!0),v.stroke()}}}}),u){L.$6l=o(u),z(u,s.getEditRectPadding()/t);var lr={x:u.x+u.width/2,y:u.y+u.height/2},ki=us(lr,u.width,u.height,a),hb=ki[0],Zl=ki[1],Jj=ki[2],Md=ki[3],Bg=ki[4],lc=ki[5],As=ki[6],Rq=ki[7];if(hb=Yj(ki[0],t),Zl=Yj(ki[1],t),Jj=Yj(ki[2],t),Md=Yj(ki[3],t),Bg=Yj(ki[4],t),lc=Yj(ki[5],t),As=Yj(ki[6],t),Rq=Yj(ki[7],t),L.$8l=u,w>0&&(L.$16l=[hb,Bg,Zl,lc,Md,As,Jj,Rq],v.beginPath(),v.lineWidth=1,v.strokeStyle=N,"dashed"===P&&v.setLineDash&&v.setLineDash(S),v.moveTo(hb.x,hb.y),v.lineTo(Zl.x,Zl.y),v.lineTo(Md.x,Md.y),v.lineTo(Jj.x,Jj.y),v.lineTo(hb.x,hb.y),v.stroke(),"dashed"===P&&v.setLineDash&&v.setLineDash([])),v.beginPath(),v.lineWidth=1,v.fillStyle=d,v.strokeStyle=T,w>0){var xs=lc.x-Rq.x,Ck=lc.y-Rq.y,Ug=B(xs*xs+Ck*Ck),nh=Bg.x-As.x,Wd=Bg.y-As.y,sd=B(nh*nh+Wd*Wd),Hm=2*k;if(s.isDirectionEditable&&1===Uc.length){var rs=Uc[0],rk=s.getDataUI(rs),ip=rk._55O,$i=s.isDirectionEditable.bind(s);if(ip._42O){var ei,Ij,Vj,yl;$i(rs,"northwest")&&(ei=!0,v.rect(hb.x-c,hb.y-c,k,k)),$i(rs,"northeast")&&(Ij=!0,v.rect(Zl.x-c,Zl.y-c,k,k)),$i(rs,"southwest")&&(Vj=!0,v.rect(Jj.x-c,Jj.y-c,k,k)),$i(rs,"southeast")&&(yl=!0,v.rect(Md.x-c,Md.y-c,k,k)),$i(rs,"north")&&(ei&&Ij?Ug>Hm&&v.rect(Bg.x-c,Bg.y-c,k,k):v.rect(Bg.x-c,Bg.y-c,k,k)),$i(rs,"south")&&(yl&&Vj?Ug>Hm&&v.rect(As.x-c,As.y-c,k,k):v.rect(As.x-c,As.y-c,k,k)),$i(rs,"west")&&(Vj&&ei?sd>Hm&&v.rect(Rq.x-c,Rq.y-c,k,k):v.rect(Rq.x-c,Rq.y-c,k,k)),$i(rs,"east")&&(yl&&Ij?sd>Hm&&v.rect(lc.x-c,lc.y-c,k,k):v.rect(lc.x-c,lc.y-c,k,k))}}else Ug>Hm&&(v.rect(Bg.x-c,Bg.y-c,k,k),v.rect(As.x-c,As.y-c,k,k)),sd>Hm&&(v.rect(lc.x-c,lc.y-c,k,k),v.rect(Rq.x-c,Rq.y-c,k,k)),v.rect(hb.x-c,hb.y-c,k,k),v.rect(Zl.x-c,Zl.y-c,k,k),v.rect(Jj.x-c,Jj.y-c,k,k),v.rect(Md.x-c,Md.y-c,k,k)}if(_>0){var os=L.$23l=Tp(Bg,0,2*-k,a);v.moveTo(os.x+c,os.y),v.arc(os.x,os.y,c,0,g,!1)}v.fill(),v.stroke(),L.$40l&&L.$44l(v,u,a);var oq,xl,zh=s.getLeftTopHelpers(),Eb=s.getRightTopHelpers(),kq=s.getLeftBottomHelpers(),Ib=s.getRightBottomHelpers(),ci=s.getEdgeHelpers(),bi=s.getEditHelperSize(),uc=bi/2,Lj=function(h,o,N,i){"leftTop"===o?(oq=u.x*t-bi-c-("h"===i?N*(bi+c):0)-1,xl=u.y*t-bi-c-("v"===i?N*(bi+c):0)-1):"rightTop"===o?(oq=(u.x+u.width)*t+c+("h"===i?N*(bi+c):0)+1,xl=u.y*t-bi-c-("v"===i?N*(bi+c):0)-1):"leftBottom"===o?(oq=u.x*t-bi-c-("h"===i?N*(bi+c):0)-1,xl=(u.y+u.height)*t+c+("v"===i?N*(bi+c):0)+1):"rightBottom"===o&&(oq=(u.x+u.width)*t+c+("h"===i?N*(bi+c):0)+1,xl=(u.y+u.height)*t+c+("v"===i?N*(bi+c):0)+1);var f=oq+uc,g=xl+uc,m=(u.x+u.width/2)*t,G=(u.y+u.height/2)*t,q=Tp({x:m,y:G},f-m,g-G,a);if("host"===h){if(j>0)return L.$77l(v,a,q),!0}else if("edge"===h){if(C>0)return L.$80l(v,a,q),!0}else if("remove"===h){if(I>0)return Uc&&1===Uc.length&&Uc[0]instanceof A?L.$81l(v,a,{x:m+bi/2+5,y:G}):L.$81l(v,a,q),!0}else if("parent"===h){if(Z>0)return Uc&&1===Uc.length&&Uc[0]instanceof A?L.$76l(v,a,{x:m-bi/2-5,y:G}):L.$76l(v,a,q),!0}else if("elevation"===h){if(Mr>0)return L.$85l(v,a,q),!0}else if("tall"===h){if(Mc>0)return L.$86l(v,a,q),!0}else if("source"===h||"target"===h){var y=Uc[0],Y=s.getDataUI(y),e=Km(Y,!0),U=e[0],x=e[1];if(El&&"source"===h)return L.$84l(v,u,U,!0,y.isLooped(),o,N,i),!0;if(Vq&&"target"===h)return L.$84l(v,u,x,!1,y.isLooped(),o,N,i),!0}};if(zh&&zh.length>0){var zf=0;zh.forEach(function(S){Lj(S,"leftTop",zf,s.getLeftTopHelpersAlign()||"h")&&zf++})}if(Eb&&Eb.length>0){var zf=0;Eb.forEach(function(H){Lj(H,"rightTop",zf,s.getRightTopHelpersAlign()||"h")&&zf++})}if(kq&&kq.length>0){var zf=0;kq.forEach(function(C){Lj(C,"leftBottom",zf,s.getLeftBottomHelpersAlign()||"h")&&zf++})}if(Ib&&Ib.length>0){var zf=0;Ib.forEach(function(D){Lj(D,"rightBottom",zf,s.getRightBottomHelpersAlign()||"h")&&zf++})}if(ci&&ci.length>0&&((El||Vq)&&Uc&&1===Uc.length&&Uc[0]instanceof A?!0:!1)){var zf=0;ci.forEach(function(B){Lj(B,"edge",zf,"h")&&zf++})}if(L.$72l){var ik,Ye=L.$67l,Yg=L.$68l,Mo=L.$69l,fi=(L.$71l,L.$70l),Xj=L.$82l,In=L.$83l;if(1===Ye?ik=Yg:2===Ye?ik=Mo:3===Ye?ik=fi:5===Ye?ik=Xj:6===Ye&&(ik=In),ik){var Vk=s.lp(L.$72l),tj=s.getDataAt(L.$72l);if(tj&&tj instanceof Y){var Ud,Ef,as;if(L.$73l=tj,1===Ye)if(tj instanceof U.Grid)Ud=L.$75l=Ub(tj,Vk);else if(tj instanceof U.Shape){as=L.$74l=og(tj,Vk);var Ro=tj.getPoints();if(as){var Yq=as.attachIndex,Pi=Ne(tj,s.getDataUI(tj),Yq)+1,xm=Pi+1>=Ro.size()?0:Pi+1,_m=Ro.get(Pi),xd=Ro.get(xm),wn=tj.p(),oi=tj.getRotation();_m=Tp(wn,_m.x-wn.x,_m.y-wn.y,oi),xd=Tp(wn,xd.x-wn.x,xd.y-wn.y,oi),v.beginPath(),v.strokeStyle=f,v.lineWidth=H,v.moveTo(_m.x*t,_m.y*t),v.lineTo(xd.x*t,xd.y*t),v.stroke()}}Ud?Ef=Ud.rect:(Ef=p.clone(s.getDataUIBounds(tj)),p.grow(Ef,2)),v.beginPath(),v.rect(Ef.x*t,Ef.y*t,Ef.width*t,Ef.height*t),v.strokeStyle=1===Ye||4===Ye||6===Ye?q:b,v.lineWidth=2,v.setLineDash&&v.setLineDash([8,8]),v.stroke()}else delete L.$73l;Vk.x=Vk.x*t,Vk.y=Vk.y*t;var ue=Yi(ik.x,ik.y,Vk.x,Vk.y),si=Tp(ik,Vk.x-ik.x,Vk.y-ik.y,-ue),Yh=si.x-ik.x;v.translate(ik.x,ik.y),v.rotate(ue),$.width=Yh,$.height=40;var Xe=b;(1===Ye||4===Ye||6===Ye)&&(Xe=q),$.comps[0].gradientColor=Xe,p.drawImage(v,$,0,-20,Yh,40)}}}if(L.$87l&&s.sm().contains(L.$87l)){var Zj,Fh=L.$87l,ar=L.$88l,bi=s.getEditHelperSize(),uc=bi/2;if(s.isHelperEditable(Fh,"pointElevation"))if(Fh instanceof e){var eb=Fh.getPosition();Zj=p.clone(Fh.getPoints().get(ar)),Zj=Tp({x:eb.x,y:eb.y},Zj.x-eb.x,Zj.y-eb.y,Fh.getRotation()),Zj.x*=t,Zj.y*=t,v.translate(Zj.x,Zj.y),p.drawImage(v,Ad,uc,-uc,bi,bi),v.translate(-Zj.x,-Zj.y),L._pointElevationHelperPoint={x:Zj.x+bi,y:Zj.y}}else if(Fh instanceof A){var _k=pd(s.getDataUI(Fh),Fh.s("edge.points")),Zj=p.clone(_k.get(ar));Zj.x*=t,Zj.y*=t,v.translate(Zj.x,Zj.y),p.drawImage(v,Ad,uc,-uc,bi,bi),v.translate(-Zj.x,-Zj.y),L._pointElevationHelperPoint={x:Zj.x+bi,y:Zj.y}}}v.restore(),L.$5l=0}},$89l:function(M,N,H,Q){M.save();var x=this,I=x.gv,f=I.getEditHelperSize(),n=f/2;M.beginPath(),M.translate(H.x,H.y),M.rotate(N),p.drawImage(M,Q,-n,-n,f,f),M.restore()},$85l:function(v,f,T){var B=this;B.$90l=T,B.$89l(v,f,T,Ad)},$86l:function(f,B,Y){var v=this;v.$91l=Y,v.$89l(f,B,Y,vr)},$77l:function(L,$,J){var z=this;z.$68l=J,z.$89l(L,$,J,v)},$80l:function(l,j,N){var f=this;f.$70l=N,f.$89l(l,j,N,Q)},$81l:function(R,P,d){var x=this;x.$71l=d,x.$89l(R,P,d,Rk)},$76l:function(o,E,J){var p=this;p.$69l=J,p.$89l(o,E,J,N)},$84l:function(l,T,U,E,k){var x,X=this,d=X.gv,F=d.getZoom(),e=d.getEditHelperSize(),Q=e/2;U.x*=F,U.y*=F,k&&(E?U.x-=Q+5:U.x+=Q+5),U.y-=e-2,E?(X.$82l=U,x=Wg):(X.$83l=U,x=cc),l.beginPath(),l.translate(U.x,U.y),p.drawImage(l,x,-Q,-Q,e,e),l.translate(-U.x,-U.y)},$44l:function(J,s,U){J.save();var e=this.gv.getZoom(),x=B(C(s.width,2)+C(s.height,2))/2*e+10,z=x,R=z+8,H=z+18,w=U,j=s.x+s.width/2,F=s.y+s.height/2;J.translate(j*e,F*e),J.beginPath(),J.strokeStyle="rgb(150, 150, 150)";for(var h=0,A=0,V=0,S=0,a=0,i=0;360>i;i++)h=i*c/180,0===i%5&&(A=Z(h)*z,V=k(h)*z,S=Z(h)*R,a=k(h)*R,J.moveTo(A,V),J.lineTo(S,a)),0===i%45&&(A=Z(h)*z,V=k(h)*z,S=Z(h)*H,a=k(h)*H,J.moveTo(A,V),J.lineTo(S,a));J.stroke(),J.beginPath(),J.rotate(-f),J.beginPath(),J.fillStyle="rgba(255, 0, 0, 0.1)",J.strokeStyle="rgb(157, 157, 157)",J.moveTo(0,0),J.arc(0,0,H,0,U,!1),J.fill(),J.beginPath(),J.moveTo(0+H,0),J.arc(0,0,H,0,U,!1),J.stroke(),J.rotate(f),J.font="bold 12px Verdana, Arial";var E=20*k(w),L=20*Z(w),r=W(180*w/c)+"°";J.textAlign="center",J.textBaseline="middle",J.beginPath();var Q=J.measureText("365.°").width;J.fillStyle="white",J.rect(E-Q/2,-L-10,Q,20),J.fill(),J.beginPath(),J.fillStyle="rgb(79,79,79)",J.fillText(r,E,-L),J.restore()}})}(this,Object);