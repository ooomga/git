!function(N){"use strict";var X="ht",L=N[X],U=function(){return document},J=function(){return U().body},d=function(T,Q,e){T.style.setProperty(Q,e,null)},T=function(l){return U().createElement(l)},G=function(){return T("div")},g=function(){var s=T("canvas");return s},b=function(P,$){d(P,"-webkit-transform",$),d(P,"-ms-transform",$),d(P,"transform",$)},f=function(Z,o){d(Z,"-webkit-transform-origin",o),d(Z,"-ms-transform-origin",o),d(Z,"transform-origin",o)},S=function(r,B){r.appendChild(B)},P=function(I,s){I.removeChild(s)},o=N.parseInt,t=L.Default,A=t.getInternal(),E=Math.PI,w="white-space",B="visibility",l="left",s="top",K="width",z="height",I="position",Y="display",m="z-index",Q="px",e="0 0",V="absolute",k="visible",h="hidden",v="none",D="block",p="nowrap",i="rgba(0, 0, 0, 0.005)";t.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var H=L.graph.GraphView.prototype,M=H._42;H.adjustHtmlNodeIndex=!0,H._42=function(X,O){if(M.call(this,X,O),this.adjustHtmlNodeIndex)for(var o=this.getDataModel()._datas._as,w=o.length,C=1,z=0;w>z;z++){var t=o[z];if(t instanceof r){var E=this.getDataUI(t);d(E.$2f,m,C+""),d(E.$3f,m,C+1+""),C+=2}}};var Z=L.HtmlNodeUI=function(K,A){var j=this;Z.superClass.constructor.call(j,K,A);var z=j.$2f=G(),b=j.$3f=g();d(z,I,V),d(z,B,h),d(z,w,p),b.draggable=!1,d(b,I,V),d(b,Y,v),f(b,e),z.addEventListener("change",function(Z){var J=Z.target,W=J.bind||J.getAttribute("bind"),d=J.type&&"checkbox"===J.type?J.checked:J.value,C=A.getContext();W&&C&&(C[W]=d,j.$4f=JSON.stringify(C))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(p){z.addEventListener(p,this.$9f.bind(this))},j)};t.def(Z,A.ui().NodeUI,{_visible:!0,$11f:function(){var r=this,c=r.$3f,O=r._data,X=O.getDraggerImageWidth(),N=O.getDraggerImageHeight(),u=O.getDraggerImage(),n=A.initContext(c);n.beginPath(),A.setCanvas(c,X,N),A.translateAndScale(n,0,0,1),n.clearRect(0,0,X,N),t.drawImage(n,t.getImage(u),0,0,X,N),n.restore()},_80o:function(j){Z.superClass._80o.call(this,j);var c=this,y=c._data,n=y._padding,x=2*n,J=c.$2f,e=c.$3f,A=c.gv,f=A.getZoom(),r=A.getTranslateX(),P=A.getTranslateY(),g=A.getView(),T=c._83o,U=y._width,q=y._height,L=T.position,u=T.rotation,F=(U-x)/y.$5f*f,a=(q-x)/y.$6f*f,w=c._html,X=y._html,N=y.getHtmlType();if("html"===N){var t=y.getContext()||{},W=c.$4f,M=y.$10f,H=JSON.stringify(t);w&&W&&w===X&&W===H||(c.$4f=H,c._html=X,J.innerHTML=M?M(t):X)}else if(null!=N){var R=y.getHtml();"ht"===N&&(R=R.getView()),w&&w===R||(c._html=R,J.innerHTML="",S(J,R))}if(!J.parentNode){var $=A.$1f;if(!$){var p=G();d(p,I,V),d(p,m,"0"),$=A.$1f=p;var C=A._canvas.nextSibling;C?g.insertBefore(p,C):S(g,p)}S($,J),S($,e)}if(y._scalable){var O=y.$5f,_=y.$6f;b(J,"rotate("+180*(u/E)+"deg) scale("+F+","+a+")"),d(J,l,(L.x-O/f/2)*f+r+Q),d(J,s,(L.y-_/f/2)*f+P+Q)}else{var Bk=o(J.style.width),Mp=o(J.style.height),ge=o((U-x)*f),Le=o((q-x)*f),Zd="100%",se=J.children[0];d(se,K,Zd),d(se,z,Zd),(Bk!==ge||Mp!==Le)&&(d(J,K,ge+Q),d(J,z,Le+Q),"ht"===N&&X.invalidate()),b(J,"rotate("+180*(u/E)+"deg)"),d(J,l,(L.x-ge/f/2)*f+r+Q),d(J,s,(L.y-Le/f/2)*f+P+Q)}var ar=c.dragRect;A.isMovable(y)&&A.isSelected(y)&&ar?(j.save(),j.fillStyle=i,j.fillRect(ar.x,ar.y,ar.width,ar.height),j.restore(),d(e,l,ar.x*f+r+Q),d(e,s,ar.y*f+P+Q),b(e,"scale("+f+","+f+")"),d(e,Y,D),c.$11f()):d(e,Y,v),d(J,B,this._visible?k:h)},dispose:function(){var R=this.gv.$1f;R.removeChild(this.$2f),R.removeChild(this.$3f)},_84o:function(r){this._visible=r,d(this.$2f,B,r?k:h),d(this.$3f,Y,r?D:v)},_3O:function(){var F=this,c=F._data;Z.superClass._3O.call(F);var K=c.getRect();F.dragRect={x:K.x+K.width+c._padding,y:K.y+10,width:c.getDraggerImageWidth(),height:c.getDraggerImageHeight()},F._68o(F.dragRect)},rectIntersects:function(u){var O=this._79o();return L.Default.intersection(O,u)?!0:void 0},$9f:function(m){var K=this.gv,R=this._data;K.sm().contains(R)&&m.stopPropagation()}});var r=L.HtmlNode=function(){r.superClass.constructor.call(this)};L.Default.def(r,L.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:L.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(M){var V=this,v=V._html;V._html=M,"html"===V.getHtmlType()&&"Handlebars"in N&&(V.$10f=Handlebars.compile(M)),V.$13f(),V.fp("html",v,M)},setContext:function(O){var g=this,i=g._context;g._context=O,g.fp("context",i,O),g.$13f()},setScalable:function(L){var e=this,V=e._scalable;e._scalable=L,e.fp("scalable",V,L),e.$13f()},getHtmlType:function(){var F=this._html;return F?"string"==typeof F?"html":F.getView?"ht":"dom":null},$13f:function(){var r=this,U=r._html,z=r.$10f;if(U){var Q=G(),a=!1,u=r.getHtmlType();if(d(Q,I,V),d(Q,w,p),d(Q,B,h),"html"===u?(Q.innerHTML=z?z(r.getContext()||{}):U,a=!0):"ht"===u?(S(Q,U.getView()),a=!0):"dom"===u&&(S(Q,U),a=!0),a){var v=2*r._padding;S(J(),Q),r.$5f=Q.scrollWidth,r.$6f=Q.scrollHeight,r._width=r.$5f+v,r._height=r.$6f+v,r._originWidth=r._width,r._originHeight=r._height,P(J(),Q)}}},getUIClass:function(){return L.HtmlNodeUI}})}(this,Object);