!function(_,l,s){"use strict";var m="px",U="0",j="innerHTML",H="className",o=ht.Default,h=ht.Color,R=ht.Node,S="position",a="top",D="left",x=o.animate,G=o.getInternal(),K="width",U="0",g="none",y="max-height",T="font",M="background",r="border-box",u="user-select",I="box-sizing",W="overflow",d=o.isTouchable,G=o.getInternal(),X=h.titleIconBackground,L=o.scrollBarInteractiveSize,F=/msie 9/.test(_.navigator?_.navigator.userAgent.toLowerCase():""),t=null,e=function(){return document},P=function(J){return e().createElement(J)},J=function(){return P("div")},c=function(){var u=J(),M=u.style;return M.msTouchAction=g,M.cursor="default",d&&M.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",t),M.position="absolute",M.left=U,M.top=U,u},Q=function(){return P("canvas")},A=function(){return document.body},N=function(B,y,X){B.style.setProperty(y,X,t)},C=function($,m){$.style.removeProperty(m)},B=function(Q,y,z){o.def(ht.widget[Q],y,z)},q=function(T,U){T.appendChild(U)},z=function(r,Y){r.removeChild(Y)},f=function(z,M,w,m){z.addEventListener(M,w,!!m)};G.addMethod(o,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:X,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:X}]},paletteTitleLabelColor:o.labelSelectColor,paletteTitleLabelFont:o.labelFont,paletteContentLabelFont:o.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:o.widgetTitleHeight,paletteTitleBackground:h.titleBackground,paletteTitleHoverBackground:h.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:s,paletteItemHoverBorderColor:h.highlight,paletteItemSelectBackground:h.highlight},!0);var k=".palette-item:hover{border: 1px solid "+o.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+o.paletteTitleHoverBackground+" !important}",w=document.createElement("style");d||(w.styleSheet?w.styleSheet.cssText=k:w.appendChild(e().createTextNode(k))),e().getElementsByTagName("head")[0].appendChild(w);var p=function(z){var e=this;e.$22h=z,e.addListeners()};o.def(p,l,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var a=this;a.$36h&&A().removeChild(a.$36h),a.$23h=a.$24h=a.$25h=a.$35h=a.$36h=t},handle_touchstart:function(S){for(var b,B=this,A=B.$22h,J=S.target,z=A.sm(),L=A.dm(),s="palette-header",T="palette-header-tool",i="palette-item",V=!1,v=!1,c=!1;J&&(J[H]||"").indexOf(s)<0&&(J[H]||"").indexOf(i)<0;)J=J.parentNode;if(J&&J[H].indexOf(T)>=0?V=!0:J&&J[H].indexOf(s)>=0?c=!0:J&&J[H].indexOf(i)>=0&&(v=!0),o.isLeftButton(S))if(B.$27h(S))B.$24h=o.getClientPoint(S),B.$25h=A.ty();else if(V){o.preventDefault(S),b=J.parentNode.$11h;var q=L.getDataById(b),D=q.s("tools")[J.toolIndex];D.action&&D.action.call(A)}else if(c){o.preventDefault(S),b=J.$11h;var q=L.getDataById(b);q.isExpanded()?q.setExpanded(!1):q.setExpanded(!0)}else if(v){b=J.$11h;var $=L.getDataById(b);z.ss($),A.handleDragAndDrop&&(o.preventDefault(S),$.s("draggable")&&(A.handleDragAndDrop(S,"prepare"),B.$35h=0)),$.s("draggable")||(o.preventDefault(S),B.$24h=o.getClientPoint(S),B.$25h=A.ty())}else o.preventDefault(S),B.$24h=o.getClientPoint(S),B.$25h=A.ty();else B.$26h(S)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_mousewheel:function(B){this.handleScroll(B,B.wheelDelta/40,B.wheelDelta!==B.wheelDeltaX)},handle_DOMMouseScroll:function(u){this.handleScroll(u,-u.detail,1)},handleScroll:function(E,v,m){var W=this.$22h;o.preventDefault(E),m&&W._41o()&&W.ty(W.ty()+20*v)},handle_mouseup:function(D){this.handle_touchend(D)},handle_touchend:function(m){var n=this;n.$37h(m),n.$26h(m)},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(z){var l=this;l.$37h(z),l.$26h(z)},$37h:function(S){var j=this,y=j.$22h;2===j.$35h&&(j.$35h=3,y.handleDragAndDrop(S,"end"))},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(N){var J=this,X=J.$22h,j=J.$23h,b=J.$24h,i=J.$25h,x=o.getClientPoint(N),_=X._29I,R=J.$36h;if(1===J.$35h||2===J.$35h){if(J.$35h=2,X.handleDragAndDrop(N,"between"),d){var s=N.touches[0];N=s?s:N.changedTouches[0]}R.style.left=N.pageX-parseInt(R.width)/2+m,R.style.top=N.pageY-parseInt(R.height)/2+m}else"p"===j?X.ty(i+x.y-b.y):"v"===j&&X.ty(i+(b.y-x.y)/_.height*X._59I)},handle_mousemove:function(U){this.handle_touchmove(U)},handle_touchmove:function(l){if(!o.isDragging()&&o.isLeftButton(l)){var p=this,v=p.$22h,P=p.$27h(l);if(p.$24h){if(!p.$23h){if(o.getDistance(o.getClientPoint(l),p.$24h)<2)return;p.$23h=P?"v":"p",o.startDragging(p)}}else if(P)v._43o();else if(0===p.$35h){if(p.$35h=1,v.handleDragAndDrop(l,"begin"),d){var N=l.touches[0];l=N?N:l.changedTouches[0]}var M=p.$36h=new Image,b=v.$10h[v.sm().ld().getId()].querySelector(".image-box"),e=parseInt(b.style.width),F=parseInt(b.style.height);M.draggable=!1,M.src=b.toDataURL(),M.width=e,M.height=F,M.style.position="absolute",M.style.left=l.pageX-e/2+m,M.style.top=l.pageY-F/2+m,A().appendChild(M),o.startDragging(p)}}},$27h:function(J){var D=this.$22h,k=D.getView(),P=k.getBoundingClientRect(),K=D._29I,F=J.clientX-P.left+k.scrollLeft;return D._41o()&&K.x+K.width-F<L}}),ht.widget.Palette=function(S){var G=this,Y=G._view=J();G.$9h={},G.$10h={},G.$4h={},G._29I={x:0,y:0,width:0,height:0},G._59I=0,G.dm(S?S:new ht.DataModel),Y[H]="ht-widget-palette",G.$29h=new p(G),N(Y,M,o.paletteContentBackground),N(Y,W,"auto"),N(Y,I,r),N(Y,"-moz-"+I,r),N(Y,"-webkit-"+u,g),N(Y,"-moz-"+u,g),N(Y,"-ms-"+u,g),N(Y,u,g),N(Y,"position","absolute"),N(Y,"overflow","hidden"),q(Y,G._79O=c()),f(Y,"dragstart",function(C){C.dataTransfer&&(C.dataTransfer.setData("Text","nodeid:"+C.target.$11h),C.dataTransfer.effectAllowed="all",G.$29h.$26h())})},B("Palette",l,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:o.autoHideScrollBar,_scrollBarSize:o.scrollBarSize,_scrollBarColor:o.scrollBarColor,getViewRect:function(){return this._29I},ty:function(u){return u?(this.setTranslateY(u),void 0):this.getTranslateY()},setTranslateY:function(U){if(this.$32h==t){var s=this,Z=s.$33h(U),g=s.$30h;s.$30h=Z,s.fp("translateY",g,Z)}},getTranslateY:function(){return this.$30h},setLayout:function(n){var O,s,H=this,k=H._layout;H._layout=n,"smallicons"===n?O=s=20:"iconsonly"===n?O=s=50:(O=70,s=50),H.setItemImageWidth(O),H.setItemImageHeight(s),H.setItemImagePadding(4),H.fp("layout",k,n)},getDataAt:function(X){for(var q=X.target;q&&q.$11h==t;)q=q.parentNode;return q&&q.$11h!=t?this.getDataModel().getDataById(q.$11h):void 0},$20h:function(){var s=16;return d&&(s*=1.2),s},$19h:function(){return o.paletteTitleHeight},$18h:function(){var B=o.paletteSeparatorWidth,G=o.paletteTitleBackground,v=o.paletteSeparatorColor||o.brighter(G);return B+m+" solid "+v},$17h:function(T){N(T,"cursor","pointer"),N(T,"display","inline-block"),N(T,"margin-right",(d?8:4)+m),N(T,"vertical-align",a)},$1h:function(C){var L=this,y=J(),O=J(),z=P("span");y[H]="palette-header",N(y,S,"relative"),N(y,M,o.paletteTitleBackground),N(y,"color",o.paletteTitleLabelColor),N(y,a,U),N(y,I,r),N(y,"-moz-"+I,r),N(y,"padding","0 5px 0 0"),N(y,"border-top",L.$18h()),N(y,K,"100%"),N(y,"cursor","pointer"),N(y,"white-space","nowrap"),N(y,W,"hidden"),N(y,T,o.paletteTitleLabelFont),N(y,"line-height",L.$19h()+m),y.$11h=C.getId();var F=Q(),c=L.$19h(),B=L.$20h();L.$17h(F),G.setCanvas(F,B,c),q(y,F);var Z=C.s("tools");if(Z)for(var b=0;b<Z.length;b++){var g=Q();L.$17h(g),G.setCanvas(g,B,c),g[H]="palette-header-tool palette-header-tool"+C.getId()+"-"+b,g.style.position="absolute",g.style.right=(B+10)*b+"px",g.toolIndex=b,q(y,g)}return F[H]="palette-toggle-icon-"+C.getId(),O[H]="palette-content",N(O,"max-height",0+m),N(O,T,o.paletteContentLabelFont),N(O,W,"hidden"),O.$11h=C.getId(),L.$9h[C.getId()]=O,z[j]=C.getName(),N(z,T,o.paletteTitleLabelFont),q(y,F),q(y,z),[y,O]},$2h:function(h){var C=this,R=C._layout,l=F&&h.s("draggable")?P("a"):J(),O=Q(),p=J(),n=h.getName()||"",Y=h.s("title")||h.getToolTip()||n,w=C._itemMargin;O[H]="image-box";var c=C.getItemImageWidth(),L=C.getItemImageHeight();return G.setCanvas(O,c,L),q(l,O),p[j]=n,p[H]="label-box","iconsonly"!==R&&q(l,p),l[H]="palette-item",N(l,"vertical-align",a),N(l,"cursor","pointer"),N(l,"border-radius",5+m),N(l,"border","1px solid transparent"),N(l,"text-align","center"),N(l,"display","inline-block"),N(l,"margin-left",w+m),N(l,"margin-top",w+m),N(l,"color",o.paletteContentLabelColor),"smallicons"===R?(N(O,"vertical-align","middle"),N(l,"margin-left",2+m),N(l,"margin-top",2+m),N(l,"padding",2+m),N(l,"text-align",D),N(p,"display","inline-block"),N(p,"min-width",C.$21h+C._itemMargin+m)):"largeicons"===R&&(N(p,"max-width",c+m),N(p,"overflow","hidden")),l.$11h=h.getId(),Y&&(l.title=Y),h.s("draggable")&&!C.handleDragAndDrop&&(F?(l.href="#",N(l,"text-decoration",g)):l.draggable="true"),l},$16h:function(D,$,A,F){var M=G.initContext(D);G.translateAndScale(M,0,0,1),M.clearRect(0,0,A,A);var Y=(A-F)/2;o.drawStretchImage(M,o.getImage($),"fill",0,Y,F,F),M.restore()},$15h:function(q){var A=this,R=q.getId(),s=A._view.querySelector(".palette-toggle-icon-"+R),W=q.isExpanded()?o.paletteCollapseIcon:o.paletteExpandIcon;if(s&&W){var g=A.$19h(),f=A.$20h();A.$16h(s,W,g,f)}},_drawToolsIcon:function(w){var E=this,L=w.s("tools");if(L)for(var n=0;n<L.length;n++){var J=E._view.querySelector(".palette-header-tool"+w.getId()+"-"+n),N=L[n].icon,P=E.$19h(),r=E.$20h();E.$16h(J,N,P,r)}},$14h:function(j){var V=this,x=j.getId(),d=V.$10h[x].querySelector(".image-box"),_=j.getImage(),C=j.s("image.stretch");if(d&&_){var l=G.initContext(d),e=V.getItemImagePadding();e="smallicons"===V._layout?e/2:e;var S=V.getItemImageWidth()-2*e,X=V.getItemImageHeight()-2*e;G.translateAndScale(l,0,0,1),l.clearRect(0,0,S,X),o.drawStretchImage(l,o.getImage(_),C,e,e,S,X,j,V),l.restore()}},validateImpl:function(){var K,T,D,u=this,N=u.$9h,f=u._layout,I=u.$10h,i=u.$4h,k=u._view,w=u.dm();if(u.$13h&&(delete u.$13h,i={},w.each(function(J){i[J.getId()]=J})),"smallicons"===f)for(var S in i){var p=i[S];if(p instanceof R){var C=p.getName()||"",J=o.getTextSize(o.paletteContentLabelFont,C).width;u.$21h!=t&&u.$21h>J||(u.$21h=J)}}for(var S in i){D=i[S];var Z,E;if(w.contains(D)){if(D instanceof ht.Group){var B,H=u.$1h(D),X=I[D.getId()];X&&(B=X.nextSibling,z(k,B),z(k,X)),T=w.getSiblings(D).indexOf(D);var b=k.children[2*T]||u._79O;k.insertBefore(H[0],b),k.insertBefore(B||H[1],b),I[D.getId()]=H[0],K=N[D.getId()]=B||H[1],E=D.$12h;var W=D.s("promptText");E||(D.$12h=P("div"),D.$12h[j]=W||"",E=D.$12h),0===D.getChildren().size()?K.contains(E)||q(K,E):K.contains(E)&&z(K,E)}else if(Z=D.getParent()){var g=u.$2h(D),L=I[D.getId()];K=N[Z.getId()],L&&z(L.parentNode,L),T=w.getSiblings(D).indexOf(D);var O=K.children[T];O?K.insertBefore(g,O):q(K,g),I[D.getId()]=g,u.$14h(D)}}else{var V=I[D.getId()],Y=V.parentNode;if(D instanceof ht.Group){var d=V.nextSibling;z(k,V),z(k,d),delete N[D.getId()]}else z(Y,V),0===Y.children.length&&(Z=w.getDataById(Y.$11h),E=Z.$12h,E&&!Y.contains(E)&&q(Y,E));delete I[D.getId()]}}u.$4h={};var r=function(){var s=u._59I,D=0;u.$32h!=t&&(clearInterval(u.$32h),D=0,delete u.$32h),u.$32h=setInterval(function(){u.$31h(),s===u._59I?(D++,D>=2&&(clearInterval(u.$32h),delete u.$32h)):(D=0,s=u._59I)},30)};for(var s in N)if(K=N[s],D=w.getDataById(N[s].$11h),u.$15h(D),u._drawToolsIcon(D),D.isExpanded()){if(K.style.maxHeight===0+m){var A=K.scrollHeight+u._itemMargin+m;x(K).duration(200).set(y,A).set("padding-bottom",u._itemMargin+m).end(function(){return function(){r()}}(A))}else K.style.maxHeight=K.scrollHeight+m;K.style.paddingBottom=u._itemMargin+m}else K.style.maxHeight!==0+m&&x(K).duration(200).set(y,U).set("padding-bottom",U).end(function(){return function(){r()}}(K));u.$28h(),u.$31h()},$31h:function(){for(var p=this,G=p._view,x=0,l=G.children,W=0;W<l.length;W++){var C=l[W];C.className&&C.className.indexOf("palette-")>=0&&(x+=C.offsetHeight)}p._59I=x,p.$30h=p.$33h(p.ty());var u=p.ty();G.scrollTop=-u,p._29I={x:0,y:-u,width:G.clientWidth,height:G.clientHeight},N(p._79O,a,-u+m),p._93I()},$33h:function(O){var s=this,c=s._29I.height-s._59I;return c>O&&(O=c),O>0?0:Math.round(O)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(L){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(L.property)<0&&this.redraw(),"translateY"===L.property&&(this.iv(),this._43o())},findDataByName:function(A){for(var i=this.dm().getDatas(),p=0;p<i.size();p++){var n=i.get(p);if(n.getName()===A)return n}},setDataModel:function(v){var O=this,F=O._dataModel,Q=O._3o;F!==v&&(F&&(F.umm(O.$6h,O),F.umd(O.$8h,O),F.umh(O.$7h,O),Q||F.sm().ums(O.$28h,O)),O._dataModel=v,v.mm(O.$6h,O),v.md(O.$8h,O),v.mh(O.$7h,O),Q?Q._21I(v):v.sm().ms(O.$28h,O),O.sm().setSelectionMode("single"),O.fp("dataModel",F,v))},$6h:function(t){var _=this,P=_._view,Y=t.data,i=_.$4h;"add"===t.kind?i[Y.getId()]=Y:"remove"===t.kind?i[Y.getId()]=Y:"clear"===t.kind&&(_.$10h={},_.$9h={},_.$4h={},P[j]=""),_.iv()},$7h:function(m){var r=this,u=m.data;r.$4h[u.getId()]=u,r.iv()},$8h:function(r){var Z=this,q=r.data,H=r.property;"expanded"===H?Z.iv():(Z.$4h[q.getId()]=q,Z.iv())},$28h:function(){var A,v=this,$=v.sm(),x="palette-item",W=$.ld();this.dm().each(function(i){A=v.$10h[i.getId()],A&&A[H].indexOf(x)>=0&&(i===W?N(A,M,o.paletteItemSelectBackground):C(A,M))})}})}(this,Object);