!function(G){"use strict";var H="ht",i=G[H],r=Math,Y=r.max,d=r.min,B=r.abs,z=r.atan2,w=r.cos,C=r.sin,J=r.ceil,D=i.Default,v=D.getInternal(),h=i.List,K=v.Mat,I=v.getNodeRect,U=v.intersectionLineRect,R=D.getDistance,j=D.setEdgeType,y="left",M="right",L="top",m="bottom",s="edge.type",n="edge.gap",P="edge.center",N="edge.extend",p=function(v,M){return I(v,M).width},f=function(g,a){return I(g,a).height},t=function(m,d){var p=v.getPosition(d.s("edge.source.position"),I(m,d._40I));return p.x+=d.s("edge.source.offset.x"),p.y+=d.s("edge.source.offset.y"),p},O=function(h,F){var V=v.getPosition(F.s("edge.target.position"),I(h,F._41I));return V.x+=F.s("edge.target.offset.x"),V.y+=F.s("edge.target.offset.y"),V},e=function(Q,P){var u=Q.s(s),q=Q.getEdgeGroup();if(q){var l=0;if(q.eachSiblingEdge(function(G){P.isVisible(G)&&G.s(s)==u&&l++}),l>1)return Q.s(n)*(l-1)/2}return 0},k=function(F,P){var e=F.s(s),z=F.isLooped();if(!F.getEdgeGroup())return z?F.s(n):0;var f,u=0,H=0,I=0;return F.getEdgeGroup().getSiblings().each(function(c){c.each(function(U){if(U._40I===F._40I&&U.s(s)==e&&P.isVisible(U)){var r=U.s(n);f?(H+=I/2+r/2,I=r):(f=U,I=r),U===F&&(u=H)}})}),z?H-u+I:u-H/2},c=function(x,Q){var F=x.size(),m=Q.s("edge.corner.radius");if(0===m)return{points:x,segments:new h([1,F])};if(0>m)return{points:x};var k,l=new h,M=new h,g=x.get(0);l.add(g),M.add(1);for(var W=1;F>W;W++)if(F>W+1){var r=x.get(W),v=x.get(W+1),H=g.x,o=g.y,S=r.x,u=r.y,f=u-o,X=S-H,V=z(f,X);k=d(.99*R(g,r),m),l.add({x:S-k*w(V),y:u-k*C(V)}),l.add(r),H=r.x,o=r.y,S=v.x,u=v.y,f=u-o,X=S-H,V=z(f,X),k=d(.99*R(r,v),m),g={x:H+k*w(V),y:o+k*C(V)},l.add(g),M.addAll([2,3])}else l.add(x.get(W)),M.add(2);return{points:l,segments:M}};v.addMethod(i.Style,{"edge.ripple.elevation":-20,"edge.ripple.size":1,"edge.ripple.both":!1,"edge.ripple.straight":!1,"edge.ripple.length":-1,"edge.corner.radius":-1,"edge.ortho":.5,"edge.flex":20,"edge.extend":20},!0),j("boundary",function(k,A,y,E){E||(A=-A);var j,$=t(y,k),Y=O(y,k),F=I(y,k._40I),H=I(y,k._41I),e=new K(z(Y.y-$.y,Y.x-$.x)),o=R($,Y),l=$.x,f=$.y;return j=e.tf(0,A),$={x:j.x+l,y:j.y+f},j=e.tf(o,A),Y={x:j.x+l,y:j.y+f},j=U($,Y,F),j&&($={x:j[0],y:j[1]}),j=U($,Y,H),j&&(Y={x:j[0],y:j[1]}),{points:new h([$,Y])}}),j("ripple",function(g,x,j,u){u||(x=-x);var f=t(j,g),M=O(j,g),N=R(f,M),p=d(g.s("edge.offset"),N/2),S=g.s("edge.ripple.size"),L=g.s("edge.ripple.length"),I=g.s("edge.ripple.both"),y=g.s(P),b=g.s("edge.ripple.elevation"),m=new h,s=g.s("edge.ripple.straight")?null:new h,T=new K(z(M.y-f.y,M.x-f.x));u||(b=-b),N-=2*p,L>0&&(S=J(N/L));var k=N/S;s&&s.add(1);for(var e=0;S>e;e++)s&&s.add(3),0===e?m.add({x:p+k*e,y:y?0:x}):m.add({x:p+k*e,y:x}),m.add({x:p+k*e+k/2,y:b+x}),I&&(b=-b);for(m.add({x:p+N,y:y?0:x}),e=0;e<m.size();e++){var Z=T.tf(m.get(e));Z.x+=f.x,Z.y+=f.y,m.set(e,Z)}return{points:m,segments:s}}),j("h.v",function(K,r,$){r=k(K,$);var g=new h,L=K.s(P),j=t($,K),S=j.x,i=j.y,T=O($,K),A=T.x,J=T.y,m=0,X=0,u=A-S,s=J-i;return L||(m=p($,K._40I)/2,X=f($,K._41I)/2),u>=0&&0>=s?(g.add({x:S+m,y:i+r}),g.add({x:A+r,y:i+r}),g.add({x:A+r,y:J+X})):0>=u&&s>=0?(g.add({x:S-m,y:i+r}),g.add({x:A+r,y:i+r}),g.add({x:A+r,y:J-X})):u>=0&&s>=0?(g.add({x:S+m,y:i+r}),g.add({x:A-r,y:i+r}),g.add({x:A-r,y:J-X})):(g.add({x:S-m,y:i+r}),g.add({x:A-r,y:i+r}),g.add({x:A-r,y:J+X})),c(g,K)}),j("v.h",function(g,G,i){G=k(g,i);var m=new h,Q=g.s(P),B=t(i,g),q=B.x,l=B.y,M=O(i,g),R=M.x,S=M.y,b=0,n=0,$=R-q,a=S-l;return Q||(b=p(i,g._41I)/2,n=f(i,g._40I)/2),$>=0&&0>=a?(m.add({x:q+G,y:l-n}),m.add({x:q+G,y:S+G}),m.add({x:R-b,y:S+G})):0>=$&&a>=0?(m.add({x:q+G,y:l+n}),m.add({x:q+G,y:S+G}),m.add({x:R+b,y:S+G})):$>=0&&a>=0?(m.add({x:q-G,y:l+n}),m.add({x:q-G,y:S+G}),m.add({x:R-b,y:S+G})):(m.add({x:q-G,y:l-n}),m.add({x:q-G,y:S+G}),m.add({x:R+b,y:S+G})),c(m,g)}),j("ortho",function(C,Q,J){var K=new h,H=C.s(P),w=C.s("edge.ortho"),U=C._40I,l=C._41I,o=t(J,C),T=o.x,_=o.y,m=O(J,C),q=m.x,u=m.y,x=q-T,Y=u-_,R=H?0:p(J,U)/2,F=H?0:f(J,U)/2,L=H?0:p(J,l)/2,g=H?0:f(J,l)/2,r=(x-(R+L)*(x>0?1:-1))*w,k=(Y-(F+g)*(Y>0?1:-1))*w;return B(x)<B(Y)?x>=0&&0>=Y?(K.add({x:T+Q,y:_-F}),K.add({x:T+Q,y:_+k+Q-F}),K.add({x:q+Q,y:_+k+Q-F}),K.add({x:q+Q,y:u+g})):0>=x&&Y>=0?(K.add({x:T+Q,y:_+F}),K.add({x:T+Q,y:_+k+Q+F}),K.add({x:q+Q,y:_+k+Q+F}),K.add({x:q+Q,y:u-g})):x>=0&&Y>=0?(K.add({x:T+Q,y:_+F}),K.add({x:T+Q,y:_+k-Q+F}),K.add({x:q+Q,y:_+k-Q+F}),K.add({x:q+Q,y:u-g})):(K.add({x:T+Q,y:_-F}),K.add({x:T+Q,y:_+k-Q-F}),K.add({x:q+Q,y:_+k-Q-F}),K.add({x:q+Q,y:u+g})):x>=0&&0>=Y?(K.add({x:T+R,y:_+Q}),K.add({x:T+r+Q+R,y:_+Q}),K.add({x:T+r+Q+R,y:u+Q}),K.add({x:q-L,y:u+Q})):0>=x&&Y>=0?(K.add({x:T-R,y:_+Q}),K.add({x:T+r+Q-R,y:_+Q}),K.add({x:T+r+Q-R,y:u+Q}),K.add({x:q+L,y:u+Q})):x>=0&&Y>=0?(K.add({x:T+R,y:_+Q}),K.add({x:T+r-Q+R,y:_+Q}),K.add({x:T+r-Q+R,y:u+Q}),K.add({x:q-L,y:u+Q})):(K.add({x:T-R,y:_+Q}),K.add({x:T+r-Q-R,y:_+Q}),K.add({x:T+r-Q-R,y:u+Q}),K.add({x:q+L,y:u+Q})),c(K,C)}),j("flex",function(C,L,T){var u=new h,K=C.s("edge.flex")+e(C,T),m=C.s(P),l=C._40I,r=C._41I,Z=t(T,C),v=Z.x,R=Z.y,E=O(T,C),d=E.x,V=E.y,g=d-v,S=V-R,D=m?0:p(T,l)/2,q=m?0:f(T,l)/2,X=m?0:p(T,r)/2,z=m?0:f(T,r)/2,H=g>0?K:-K,y=S>0?K:-K;return B(g)<B(S)?g>=0&&0>=S?(u.add({x:v+L,y:R-q}),u.add({x:v+L,y:R+y+L-q}),u.add({x:d+L,y:V-y+L+z}),u.add({x:d+L,y:V+z})):0>=g&&S>=0?(u.add({x:v+L,y:R+q}),u.add({x:v+L,y:R+y+L+q}),u.add({x:d+L,y:V-y+L-z}),u.add({x:d+L,y:V-z})):g>=0&&S>=0?(u.add({x:v+L,y:R+q}),u.add({x:v+L,y:R+y-L+q}),u.add({x:d+L,y:V-y-L-z}),u.add({x:d+L,y:V-z})):(u.add({x:v+L,y:R-q}),u.add({x:v+L,y:R+y-L-q}),u.add({x:d+L,y:V-y-L+z}),u.add({x:d+L,y:V+z})):g>=0&&0>=S?(u.add({x:v+D,y:R+L}),u.add({x:v+H+L+D,y:R+L}),u.add({x:d-H+L-X,y:V+L}),u.add({x:d-X,y:V+L})):0>=g&&S>=0?(u.add({x:v-D,y:R+L}),u.add({x:v+H+L-D,y:R+L}),u.add({x:d-H+L+X,y:V+L}),u.add({x:d+X,y:V+L})):g>=0&&S>=0?(u.add({x:v+D,y:R+L}),u.add({x:v+H-L+D,y:R+L}),u.add({x:d-H-L-X,y:V+L}),u.add({x:d-X,y:V+L})):(u.add({x:v-D,y:R+L}),u.add({x:v+H-L-D,y:R+L}),u.add({x:d-H-L+X,y:V+L}),u.add({x:d+X,y:V+L})),c(u,C)}),j("extend.east",function(Q,b,E){var z=new h,x=Q.s(N)+e(Q,E),i=Q.s(P),V=t(E,Q),I=V.x+(i?0:p(E,Q._40I)/2),y=V.y,F=O(E,Q),J=F.x+(i?0:p(E,Q._41I)/2),n=F.y,B=Y(I,J)+x;return y>n?(z.add({x:I,y:y+b}),z.add({x:B+b,y:y+b}),z.add({x:B+b,y:n-b}),z.add({x:J,y:n-b})):(z.add({x:I,y:y-b}),z.add({x:B+b,y:y-b}),z.add({x:B+b,y:n+b}),z.add({x:J,y:n+b})),c(z,Q)}),j("extend.west",function(k,M,D){var S=new h,b=k.s(N)+e(k,D),g=k.s(P),F=t(D,k),z=F.x-(g?0:p(D,k._40I)/2),o=F.y,s=O(D,k),U=s.x-(g?0:p(D,k._41I)/2),W=s.y,f=d(z,U)-b;return o>W?(S.add({x:z,y:o+M}),S.add({x:f-M,y:o+M}),S.add({x:f-M,y:W-M}),S.add({x:U,y:W-M})):(S.add({x:z,y:o-M}),S.add({x:f-M,y:o-M}),S.add({x:f-M,y:W+M}),S.add({x:U,y:W+M})),c(S,k)}),j("extend.north",function(Y,Z,V){var K=new h,T=Y.s(N)+e(Y,V),s=Y.s(P),X=t(V,Y),x=X.x,b=X.y-(s?0:f(V,Y._40I)/2),A=O(V,Y),j=A.x,Q=A.y-(s?0:f(V,Y._41I)/2),u=d(b,Q)-T;return x>j?(K.add({y:b,x:x+Z}),K.add({y:u-Z,x:x+Z}),K.add({y:u-Z,x:j-Z}),K.add({y:Q,x:j-Z})):(K.add({y:b,x:x-Z}),K.add({y:u-Z,x:x-Z}),K.add({y:u-Z,x:j+Z}),K.add({y:Q,x:j+Z})),c(K,Y)}),j("extend.south",function(C,n,y){var z=new h,R=C.s(N)+e(C,y),x=C.s(P),b=t(y,C),D=b.x,k=b.y+(x?0:f(y,C._40I)/2),I=O(y,C),A=I.x,a=I.y+(x?0:f(y,C._41I)/2),V=Y(k,a)+R;return D>A?(z.add({y:k,x:D+n}),z.add({y:V+n,x:D+n}),z.add({y:V+n,x:A-n}),z.add({y:a,x:A-n})):(z.add({y:k,x:D-n}),z.add({y:V+n,x:D-n}),z.add({y:V+n,x:A+n}),z.add({y:a,x:A+n})),c(z,C)});var u=function(J,u,k,F,w){if(F.sort(function(W,s){var O=W.getSourceAgent()===u?W.getTargetAgent():W.getSourceAgent(),I=s.getSourceAgent()===u?s.getTargetAgent():s.getSourceAgent(),x=O.p(),H=I.p();if(k===y||k===M){if(x.y>H.y)return 1;if(x.y<H.y)return-1}else{if(x.x>H.x)return 1;if(x.x<H.x)return-1}return D.sortFunc(W.getId(),s.getId())}),w){for(var B,T,e,j=J.getSourceAgent(),r=J.getTargetAgent(),m=0;m<F.size();m++){var g=F.get(m);g.getSourceAgent()===j&&g.getTargetAgent()===r||g.getTargetAgent()===j&&g.getSourceAgent()===r?(T||(T=new h),T.add(g,0)):T?(e||(e=new h),e.add(g)):(B||(B=new h),B.add(g))}F.clear(),B&&F.addAll(B),T&&F.addAll(T),e&&F.addAll(e)}var q=F.indexOf(J),I=F.size(),z=J.s(n);return{side:k,index:q,size:I,offset:-z*(I-1)/2+z*q}},A=function(J,b,l,N,k){var L=b.s(s);return u(b,l,N,l.getAgentEdges().toList(function(X){return J.isVisible(X)&&X.s(s)===L}),k)},$=function(k,f){var r=k.getSourceAgent()===f?k.getTargetAgent():k.getSourceAgent(),J=f.p(),A=r.p(),G=A.x-J.x,V=A.y-J.y;return G>0&&B(V)<=G?M:0>G&&B(V)<=-G?y:V>0&&B(G)<=V?m:L},q=function(K,h,n){var J=h.s(s),f=$(h,n);return u(h,n,f,n.getAgentEdges().toList(function(_){return K.isVisible(_)&&_.s(s)===J&&$(_,n)===f}))},o=function(h,X){var g=h.getSourceAgent()===X,i=g?h.getTargetAgent():h.getSourceAgent(),w=X.p(),o=i.p();return g?w.y>o.y?L:m:w.x<o.x?M:y},Q=function(L,I,i){var F=I.s(s),d=o(I,i);return u(I,i,d,i.getAgentEdges().toList(function(K){return L.isVisible(K)&&K.s(s)===F&&o(K,i)===d}),d===M||d===m)},b=function(l,R){var u=l.getSourceAgent()===R,S=u?l.getTargetAgent():l.getSourceAgent(),I=R.p(),U=S.p();return u?I.x<U.x?M:y:I.y>U.y?L:m},T=function(I,o,J){var Y=o.s(s),d=b(o,J);return u(o,J,d,J.getAgentEdges().toList(function(l){return I.isVisible(l)&&l.s(s)===Y&&b(l,J)===d}),d===M||d===m)},x=function(I,r,s){var d=I.getSourceAgent(),a=I.getTargetAgent(),J=d.getId()>a.getId(),W=J?a:d,Y=J?d:a,K=W.p(),V=Y.p(),u=s(r,I,W),g=s(r,I,Y),O=I.s(P),S=O?0:p(r,W)/2,$=O?0:p(r,Y)/2,z=O?0:f(r,W)/2,j=O?0:f(r,Y)/2,e=u.offset,T=g.offset,v=u.side,R=g.side,E=new h;return v===L?(E.add({x:K.x+e,y:K.y-z}),E.add({x:K.x+e,y:V.y+T}),R===y?E.add({x:V.x-$,y:V.y+T}):E.add({x:V.x+$,y:V.y+T})):v===m?(E.add({x:K.x+e,y:K.y+z}),E.add({x:K.x+e,y:V.y+T}),R===y?E.add({x:V.x-$,y:V.y+T}):E.add({x:V.x+$,y:V.y+T})):v===y?(E.add({x:K.x-S,y:K.y+e}),E.add({x:V.x+T,y:K.y+e}),R===m?E.add({x:V.x+T,y:V.y+j}):E.add({x:V.x+T,y:V.y-j})):v===M&&(E.add({x:K.x+S,y:K.y+e}),E.add({x:V.x+T,y:K.y+e}),R===m?E.add({x:V.x+T,y:V.y+j}):E.add({x:V.x+T,y:V.y-j})),J&&E.reverse(),c(E,I)};j("ortho2",function(O,Y,K){var A,H,w=O.s(P),x=O.s("edge.ortho"),b=O.getSourceAgent(),$=O.getTargetAgent(),l=b.getId()>$.getId(),r=l?$:b,z=l?b:$,t=r.p(),Z=z.p(),n=q(K,O,r),I=q(K,O,z),Q=w?0:p(K,r)/2,d=w?0:f(K,r)/2,v=w?0:p(K,z)/2,j=w?0:f(K,z)/2,R=new h,o=n.offset,s=I.offset,e=n.side;return e===M?(A=Z.y>t.y?-o:o,H=t.x+Q+(Z.x-v-t.x-Q)*x,R.add({x:t.x+Q,y:t.y+o}),R.add({x:H+A,y:t.y+o}),R.add({x:H+A,y:Z.y+s}),R.add({x:Z.x-v,y:Z.y+s})):e===y?(A=Z.y>t.y?-o:o,H=t.x-Q-(t.x-Q-Z.x-v)*x,R.add({x:t.x-Q,y:t.y+o}),R.add({x:H-A,y:t.y+o}),R.add({x:H-A,y:Z.y+s}),R.add({x:Z.x+v,y:Z.y+s})):e===m?(A=Z.x>t.x?-o:o,H=t.y+d+(Z.y-j-t.y-d)*x,R.add({x:t.x+o,y:t.y+d}),R.add({x:t.x+o,y:H+A}),R.add({x:Z.x+s,y:H+A}),R.add({x:Z.x+s,y:Z.y-j})):e===L&&(A=Z.x>t.x?-o:o,H=t.y-d-(t.y-d-Z.y-j)*x,R.add({x:t.x+o,y:t.y-d}),R.add({x:t.x+o,y:H-A}),R.add({x:Z.x+s,y:H-A}),R.add({x:Z.x+s,y:Z.y+j})),l&&R.reverse(),c(R,O)},!0),j("flex2",function(j,i,l){var G,k=j.getSourceAgent(),o=j.getTargetAgent(),U=k.getId()>o.getId(),S=U?o:k,Y=U?k:o,T=S.p(),d=Y.p(),D=q(l,j,S),x=q(l,j,Y),$=j.s(P),a=j.s("edge.flex")+(D.size-1)/2*j.s(n),Q=$?0:p(l,S)/2,r=$?0:f(l,S)/2,K=$?0:p(l,Y)/2,u=$?0:f(l,Y)/2,N=new h,C=D.offset,F=x.offset,X=D.side;return X===M?(G=d.y>T.y?-C:C,N.add({x:T.x+Q,y:T.y+C}),N.add({x:T.x+Q+a+G,y:T.y+C}),N.add({x:d.x-K-a+G,y:d.y+F}),N.add({x:d.x-K,y:d.y+F})):X===y?(G=d.y>T.y?-C:C,N.add({x:T.x-Q,y:T.y+C}),N.add({x:T.x-Q-a-G,y:T.y+C}),N.add({x:d.x+K+a-G,y:d.y+F}),N.add({x:d.x+K,y:d.y+F})):X===m?(G=d.x>T.x?-C:C,N.add({x:T.x+C,y:T.y+r}),N.add({x:T.x+C,y:T.y+r+a+G}),N.add({x:d.x+F,y:d.y-u-a+G}),N.add({x:d.x+F,y:d.y-u})):X===L&&(G=d.x>T.x?-C:C,N.add({x:T.x+C,y:T.y-r}),N.add({x:T.x+C,y:T.y-r-a-G}),N.add({x:d.x+F,y:d.y+u+a-G}),N.add({x:d.x+F,y:d.y+u})),U&&N.reverse(),c(N,j)},!0),j("extend.north2",function(R,a,q){var M=R.getSourceAgent(),Z=R.getTargetAgent(),s=M.getId()>Z.getId(),I=s?Z:M,t=s?M:Z,_=I.p(),T=t.p(),$=A(q,R,I,L),x=A(q,R,t,L,!0),E=R.s(P),b=E?0:f(q,I)/2,Q=E?0:f(q,t)/2,U=$.offset,i=x.offset,l=R.s(N)+($.size-1)/2*R.s(n),F=d(_.y-b,T.y-Q)-l+(_.x<T.x?U:-U),B=new h;return B.add({x:_.x+U,y:_.y-b}),B.add({x:_.x+U,y:F}),B.add({x:T.x+i,y:F}),B.add({x:T.x+i,y:T.y-Q}),s&&B.reverse(),c(B,R)},!0),j("extend.south2",function(g,T,D){var C=g.getSourceAgent(),Q=g.getTargetAgent(),z=C.getId()>Q.getId(),V=z?Q:C,u=z?C:Q,v=V.p(),R=u.p(),J=A(D,g,V,m),w=A(D,g,u,m,!0),Z=g.s(P),H=Z?0:f(D,V)/2,o=Z?0:f(D,u)/2,t=J.offset,r=w.offset,j=g.s(N)+(J.size-1)/2*g.s(n),y=Y(v.y+H,R.y+o)+j+(v.x>R.x?t:-t),_=new h;return _.add({x:v.x+t,y:v.y+H}),_.add({x:v.x+t,y:y}),_.add({x:R.x+r,y:y}),_.add({x:R.x+r,y:R.y+o}),z&&_.reverse(),c(_,g)},!0),j("extend.west2",function(k,R,s){var T=k.getSourceAgent(),J=k.getTargetAgent(),Z=T.getId()>J.getId(),W=Z?J:T,l=Z?T:J,g=W.p(),F=l.p(),e=A(s,k,W,L),a=A(s,k,l,L,!0),t=k.s(P),X=t?0:p(s,W)/2,x=t?0:p(s,l)/2,O=e.offset,I=a.offset,$=k.s(N)+(e.size-1)/2*k.s(n),v=d(g.x-X,F.x-x)-$+(g.y<F.y?O:-O),E=new h;return E.add({x:g.x-X,y:g.y+O}),E.add({x:v,y:g.y+O}),E.add({x:v,y:F.y+I}),E.add({x:F.x-x,y:F.y+I}),Z&&E.reverse(),c(E,k)},!0),j("extend.east2",function(K,E,o){var Q=K.getSourceAgent(),S=K.getTargetAgent(),C=Q.getId()>S.getId(),u=C?S:Q,q=C?Q:S,H=u.p(),d=q.p(),U=A(o,K,u,L),Z=A(o,K,q,L,!0),i=K.s(P),F=i?0:p(o,u)/2,R=i?0:p(o,q)/2,t=U.offset,g=Z.offset,J=K.s(N)+(U.size-1)/2*K.s(n),f=Y(H.x+F,d.x+R)+J+(H.y>d.y?t:-t),I=new h;return I.add({x:H.x+F,y:H.y+t}),I.add({x:f,y:H.y+t}),I.add({x:f,y:d.y+g}),I.add({x:d.x+R,y:d.y+g}),C&&I.reverse(),c(I,K)},!0),j("v.h2",function(X,y,n){return x(X,n,Q)},!0),j("h.v2",function(Z,j,M){return x(Z,M,T)},!0)}(this,Object);